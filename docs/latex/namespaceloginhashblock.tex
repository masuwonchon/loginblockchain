\hypertarget{namespaceloginhashblock}{}\section{loginhashblock Namespace Reference}
\label{namespaceloginhashblock}\index{loginhashblock@{loginhashblock}}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
def \hyperlink{namespaceloginhashblock_a1096aa8494b9c5875decc029d8b40ea9}{print\+\_\+\+L\+H\+Blist} (L\+H\+Blist\+Str, \hyperlink{namespaceloginhashblock_ad198a2ffc3d7bab32167aed00d2f5c65}{D\+E\+B\+UG}=False)
\item 
def \hyperlink{namespaceloginhashblock_a104d0a92cdfb6c337794b6ded42667d4}{pbkdf2\+\_\+hash} (data, salt, iterations, dklen=None, hash\+\_\+name=\char`\"{}sha256\char`\"{}, D\+E\+B\+UG=False)
\item 
def \hyperlink{namespaceloginhashblock_afe116dea3aaff238a5fa2bcd6edf2281}{create\+\_\+salt} (length, R\+A\+N\+D\+\_\+\+C\+H\+A\+RS=None, \hyperlink{namespaceloginhashblock_ad198a2ffc3d7bab32167aed00d2f5c65}{D\+E\+B\+UG}=False)
\item 
def \hyperlink{namespaceloginhashblock_a550707107141dfb228ca4294d7ea31b4}{create\+\_\+loginhashblocklist} (L\+H\+Blist\+Str, \hyperlink{namespaceloginhashblock_ad198a2ffc3d7bab32167aed00d2f5c65}{D\+E\+B\+UG}=\hyperlink{namespaceloginhashblock_ad198a2ffc3d7bab32167aed00d2f5c65}{D\+E\+B\+UG})
\item 
def \hyperlink{namespaceloginhashblock_a2bcc7ddd0fcc3788572dd77808cb624d}{update\+\_\+loginhashblocklist} (L\+H\+Blist\+Str, prev\+L\+H\+Bstr, \hyperlink{namespaceloginhashblock_ad198a2ffc3d7bab32167aed00d2f5c65}{D\+E\+B\+UG}=False)
\item 
def \hyperlink{namespaceloginhashblock_a935d8ae1c51e50f9e5db6a1d5f02b1b8}{create\+\_\+hash} (salt, target, hash\+\_\+name=\char`\"{}sha256\char`\"{}, iterations=100000, kdf=None, \hyperlink{namespaceloginhashblock_ad198a2ffc3d7bab32167aed00d2f5c65}{D\+E\+B\+UG}=False)
\item 
def \hyperlink{namespaceloginhashblock_ac7faa165bc305e611390727f11946424}{valid\+\_\+hash} (target\+\_\+hash, salt, target, method, \hyperlink{namespaceloginhashblock_ad198a2ffc3d7bab32167aed00d2f5c65}{D\+E\+B\+UG}=False)
\item 
def \hyperlink{namespaceloginhashblock_a17417f2f6bca76ab51170082a562e5f6}{get\+\_\+device\+Id} (L\+H\+Bstr, \hyperlink{namespaceloginhashblock_ad198a2ffc3d7bab32167aed00d2f5c65}{D\+E\+B\+UG}=False)
\item 
def \hyperlink{namespaceloginhashblock_a1bd31fe2f0ea4e6673127d72b6c42826}{create\+\_\+device\+Id} (\hyperlink{namespaceloginhashblock_ad198a2ffc3d7bab32167aed00d2f5c65}{D\+E\+B\+UG}=False)
\item 
def \hyperlink{namespaceloginhashblock_ac24dd842eb90e0ede55e842d44148d5b}{compare\+\_\+loginhashblock} (a, b, \hyperlink{namespaceloginhashblock_ad198a2ffc3d7bab32167aed00d2f5c65}{D\+E\+B\+UG}=False)
\item 
def \hyperlink{namespaceloginhashblock_aa5bb94484a68d0bbebce23b4cfeeb4b7}{verify\+\_\+loginhashblock} (L\+H\+Blist\+Str, L\+H\+Bstr, \hyperlink{namespaceloginhashblock_ad198a2ffc3d7bab32167aed00d2f5c65}{D\+E\+B\+UG}=False)
\item 
def \hyperlink{namespaceloginhashblock_adb424539d851426da7b65d53c5a6d577}{valid\+\_\+loginhashblock} (L\+H\+Bstr, \hyperlink{namespaceloginhashblock_ad198a2ffc3d7bab32167aed00d2f5c65}{D\+E\+B\+UG}=False)
\item 
def \hyperlink{namespaceloginhashblock_afef75d97c834ce0fda711b93d0b56b00}{update\+\_\+loginhashblock} (prev\+L\+H\+Bstr, \hyperlink{namespaceloginhashblock_ad198a2ffc3d7bab32167aed00d2f5c65}{D\+E\+B\+UG}=False)
\item 
def \hyperlink{namespaceloginhashblock_a746d5c48cd93a76b78c90c34419ebdaa}{is\+Registed\+L\+HB} (L\+H\+Bstr, L\+H\+Blist\+Str, \hyperlink{namespaceloginhashblock_ad198a2ffc3d7bab32167aed00d2f5c65}{D\+E\+B\+UG}=False)
\item 
def \hyperlink{namespaceloginhashblock_a6187961cb9009c7836e7e6e639085f93}{get\+\_\+loginhashblock} (devid, L\+H\+Blist, \hyperlink{namespaceloginhashblock_ad198a2ffc3d7bab32167aed00d2f5c65}{D\+E\+B\+UG}=False)
\item 
def \hyperlink{namespaceloginhashblock_ad3ef8dab740c69ca8424797f9c146a53}{create\+\_\+loginhashblock} (devid, key=None, \hyperlink{namespaceloginhashblock_ad198a2ffc3d7bab32167aed00d2f5c65}{D\+E\+B\+UG}=False)
\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
bool \hyperlink{namespaceloginhashblock_ad198a2ffc3d7bab32167aed00d2f5c65}{D\+E\+B\+UG} = False
\end{DoxyCompactItemize}


\subsection{Detailed Description}
\begin{DoxyVerb}LHB(login hash block) module is designed to work for account taker over attack - HMAC-based and PBKDF2 algorithms based.
It is compatible with python flask and application based on it

@version: 1.0.0
@authour: suwonchon(suwonchon@gmail.com)
@contact http://github.com/masuwonchon/loginblockchain
@license: MIT

Example usage:\end{DoxyVerb}
 

\subsection{Function Documentation}
\index{loginhashblock@{loginhashblock}!compare\+\_\+loginhashblock@{compare\+\_\+loginhashblock}}
\index{compare\+\_\+loginhashblock@{compare\+\_\+loginhashblock}!loginhashblock@{loginhashblock}}
\subsubsection[{\texorpdfstring{compare\+\_\+loginhashblock(a, b, D\+E\+B\+U\+G=\+False)}{compare_loginhashblock(a, b, DEBUG=False)}}]{\setlength{\rightskip}{0pt plus 5cm}def loginhashblock.\+compare\+\_\+loginhashblock (
\begin{DoxyParamCaption}
\item[{}]{a, }
\item[{}]{b, }
\item[{}]{D\+E\+B\+UG = {\ttfamily False}}
\end{DoxyParamCaption}
)}\hypertarget{namespaceloginhashblock_ac24dd842eb90e0ede55e842d44148d5b}{}\label{namespaceloginhashblock_ac24dd842eb90e0ede55e842d44148d5b}
\begin{DoxyVerb}This function compare two LHB in Python to check if they are identical.
:param a: compare login hash block
:param b: compare login hash block
:param DEBUG:
:return:
\end{DoxyVerb}
 

Definition at line 230 of file loginhashblock.\+py.


\begin{DoxyCode}
230 \textcolor{keyword}{def }\hyperlink{namespaceloginhashblock_ac24dd842eb90e0ede55e842d44148d5b}{compare\_loginhashblock}(a, b, DEBUG=False):
231     \textcolor{stringliteral}{"""}
232 \textcolor{stringliteral}{    This function compare two LHB in Python to check if they are identical.}
233 \textcolor{stringliteral}{    :param a: compare login hash block}
234 \textcolor{stringliteral}{    :param b: compare login hash block}
235 \textcolor{stringliteral}{    :param DEBUG:}
236 \textcolor{stringliteral}{    :return:}
237 \textcolor{stringliteral}{    """}
238 
239     \textcolor{keywordflow}{if} DEBUG:
240         print(\textcolor{stringliteral}{"[info:compare\_loginhashblock] a: "},a)
241         print(\textcolor{stringliteral}{"[info:compare\_loginhashblock] b: "},b)
242 
243     \textcolor{keywordflow}{if} isinstance(a, str):
244         a = a.encode(\textcolor{stringliteral}{"utf-8"})
245 
246     \textcolor{keywordflow}{if} isinstance(b, str):
247         b = b.encode(\textcolor{stringliteral}{"utf-8"})
248 
249     \textcolor{keywordflow}{if} len(a) != len(b):
250         \textcolor{keywordflow}{return} \textcolor{keyword}{False}
251 
252     \textcolor{keywordflow}{for} x, y \textcolor{keywordflow}{in} zip(a, b):
253         \textcolor{keywordflow}{if} x != y:
254             \textcolor{keywordflow}{return} \textcolor{keyword}{False}
255 
256     \textcolor{keywordflow}{return} \textcolor{keyword}{True}
257 
\end{DoxyCode}


Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceloginhashblock_ac24dd842eb90e0ede55e842d44148d5b_icgraph}
\end{center}
\end{figure}


\index{loginhashblock@{loginhashblock}!create\+\_\+device\+Id@{create\+\_\+device\+Id}}
\index{create\+\_\+device\+Id@{create\+\_\+device\+Id}!loginhashblock@{loginhashblock}}
\subsubsection[{\texorpdfstring{create\+\_\+device\+Id(\+D\+E\+B\+U\+G=\+False)}{create_deviceId(DEBUG=False)}}]{\setlength{\rightskip}{0pt plus 5cm}def loginhashblock.\+create\+\_\+device\+Id (
\begin{DoxyParamCaption}
\item[{}]{D\+E\+B\+UG = {\ttfamily False}}
\end{DoxyParamCaption}
)}\hypertarget{namespaceloginhashblock_a1bd31fe2f0ea4e6673127d72b6c42826}{}\label{namespaceloginhashblock_a1bd31fe2f0ea4e6673127d72b6c42826}
\begin{DoxyVerb}This function is to generate device id, Device id is used to identify client computer, terminal and environment.
devicd is created by random string as a magic number
:return:
\end{DoxyVerb}
 

Definition at line 214 of file loginhashblock.\+py.


\begin{DoxyCode}
214 \textcolor{keyword}{def }\hyperlink{namespaceloginhashblock_a1bd31fe2f0ea4e6673127d72b6c42826}{create\_deviceId}(DEBUG=False):
215     \textcolor{stringliteral}{"""}
216 \textcolor{stringliteral}{    This function is to generate device id, Device id is used to identify client computer, terminal and
       environment.}
217 \textcolor{stringliteral}{devicd is created by random string as a magic number}
218 \textcolor{stringliteral}{    :return:}
219 \textcolor{stringliteral}{    """}
220 
221     RAND\_CHARS = \textcolor{stringliteral}{"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789"}
222     devid = \hyperlink{namespaceloginhashblock_afe116dea3aaff238a5fa2bcd6edf2281}{create\_salt}(8, RAND\_CHARS=RAND\_CHARS)
223 
224     \textcolor{keywordflow}{if} DEBUG:
225         text = \textcolor{stringliteral}{"[info:create\_deviceId] devid: \{\}"}.format(devid)
226         print(text)
227 
228     \textcolor{keywordflow}{return} devid
229 
\end{DoxyCode}


Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceloginhashblock_a1bd31fe2f0ea4e6673127d72b6c42826_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceloginhashblock_a1bd31fe2f0ea4e6673127d72b6c42826_icgraph}
\end{center}
\end{figure}


\index{loginhashblock@{loginhashblock}!create\+\_\+hash@{create\+\_\+hash}}
\index{create\+\_\+hash@{create\+\_\+hash}!loginhashblock@{loginhashblock}}
\subsubsection[{\texorpdfstring{create\+\_\+hash(salt, target, hash\+\_\+name=""sha256"", iterations=100000, kdf=\+None, D\+E\+B\+U\+G=\+False)}{create_hash(salt, target, hash_name="sha256", iterations=100000, kdf=None, DEBUG=False)}}]{\setlength{\rightskip}{0pt plus 5cm}def loginhashblock.\+create\+\_\+hash (
\begin{DoxyParamCaption}
\item[{}]{salt, }
\item[{}]{target, }
\item[{}]{hash\+\_\+name = {\ttfamily \char`\"{}sha256\char`\"{}}, }
\item[{}]{iterations = {\ttfamily 100000}, }
\item[{}]{kdf = {\ttfamily None}, }
\item[{}]{D\+E\+B\+UG = {\ttfamily False}}
\end{DoxyParamCaption}
)}\hypertarget{namespaceloginhashblock_a935d8ae1c51e50f9e5db6a1d5f02b1b8}{}\label{namespaceloginhashblock_a935d8ae1c51e50f9e5db6a1d5f02b1b8}
\begin{DoxyVerb}This function is to obtain the digest of the byte target string, It uses HMAC as pseudorandom function.
:param salt, target: Target and salt are interpreted as buffers of bytes.
:param hash_name: The string hash_name is the desired name of the hash digest algorithm for HMAC
:param iterations: The number of iterations should be chosen based on the hash algorithm and computing power. As of 2013, at least 100,000 iterations of SHA-256 are suggested.
:param kdf: key derivation function(ex, bcrypt, PBKDF2 etc)
:return:
\end{DoxyVerb}
 

Definition at line 138 of file loginhashblock.\+py.


\begin{DoxyCode}
138 \textcolor{keyword}{def }\hyperlink{namespaceloginhashblock_a935d8ae1c51e50f9e5db6a1d5f02b1b8}{create\_hash}(salt, target, hash\_name="sha256", iterations=100000, kdf=None, DEBUG=False):
139     \textcolor{stringliteral}{"""}
140 \textcolor{stringliteral}{    This function is to obtain the digest of the byte target string, It uses HMAC as pseudorandom function.}
141 \textcolor{stringliteral}{    :param salt, target: Target and salt are interpreted as buffers of bytes.}
142 \textcolor{stringliteral}{    :param hash\_name: The string hash\_name is the desired name of the hash digest algorithm for HMAC}
143 \textcolor{stringliteral}{    :param iterations: The number of iterations should be chosen based on the hash algorithm and computing
       power. As of 2013, at least 100,000 iterations of SHA-256 are suggested.}
144 \textcolor{stringliteral}{    :param kdf: key derivation function(ex, bcrypt, PBKDF2 etc)}
145 \textcolor{stringliteral}{    :return:}
146 \textcolor{stringliteral}{    """}
147 
148     \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} target \textcolor{keywordflow}{or} \textcolor{keywordflow}{not} salt:
149         \textcolor{keywordflow}{raise} ValueError(\textcolor{stringliteral}{"[info:create\_hash] target string or salt is null"})
150 
151     \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} kdf:
152         h = hashlib.new(hash\_name)
153         h.update(target.encode(\textcolor{stringliteral}{'ascii'}))
154         hash = h.hexdigest()
155         method = \textcolor{stringliteral}{"none:%s:%d"} % (hash\_name, iterations)
156     \textcolor{keywordflow}{else}:
157         \textcolor{keywordflow}{if} kdf == \textcolor{stringliteral}{"pbkdf2"}:
158             hash = \hyperlink{namespaceloginhashblock_a104d0a92cdfb6c337794b6ded42667d4}{pbkdf2\_hash}(target, salt, iterations, hash\_name=hash\_name)
159             method = \textcolor{stringliteral}{"pbkdf2:%s:%d"} % (hash\_name, iterations)
160         \textcolor{keywordflow}{elif} kdf == \textcolor{stringliteral}{"scrypt"}:
161             \textcolor{keywordflow}{raise} ValueError(\textcolor{stringliteral}{"[info:create\_hash] will be supported"})
162         \textcolor{keywordflow}{else}:
163             \textcolor{keywordflow}{raise} ValueError(\textcolor{stringliteral}{"[info:create\_hash] Invalid support key derivation function"})
164 
165     \textcolor{keywordflow}{if} DEBUG:
166         text = \textcolor{stringliteral}{"[info:create\_hash] hash: \{\}, method: \{\}"}.format(hash, method)
167         print(text)
168 
169     \textcolor{keywordflow}{return} hash, method
170 
\end{DoxyCode}


Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceloginhashblock_a935d8ae1c51e50f9e5db6a1d5f02b1b8_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceloginhashblock_a935d8ae1c51e50f9e5db6a1d5f02b1b8_icgraph}
\end{center}
\end{figure}


\index{loginhashblock@{loginhashblock}!create\+\_\+loginhashblock@{create\+\_\+loginhashblock}}
\index{create\+\_\+loginhashblock@{create\+\_\+loginhashblock}!loginhashblock@{loginhashblock}}
\subsubsection[{\texorpdfstring{create\+\_\+loginhashblock(devid, key=\+None, D\+E\+B\+U\+G=\+False)}{create_loginhashblock(devid, key=None, DEBUG=False)}}]{\setlength{\rightskip}{0pt plus 5cm}def loginhashblock.\+create\+\_\+loginhashblock (
\begin{DoxyParamCaption}
\item[{}]{devid, }
\item[{}]{key = {\ttfamily None}, }
\item[{}]{D\+E\+B\+UG = {\ttfamily False}}
\end{DoxyParamCaption}
)}\hypertarget{namespaceloginhashblock_ad3ef8dab740c69ca8424797f9c146a53}{}\label{namespaceloginhashblock_ad3ef8dab740c69ca8424797f9c146a53}
\begin{DoxyVerb}This functions is to generate login hash block with devid
:param devid:
:param key:
:return: login hash block
\end{DoxyVerb}
 

Definition at line 381 of file loginhashblock.\+py.


\begin{DoxyCode}
381 \textcolor{keyword}{def }\hyperlink{namespaceloginhashblock_ad3ef8dab740c69ca8424797f9c146a53}{create\_loginhashblock}(devid, key=None, DEBUG=False):
382     \textcolor{stringliteral}{"""}
383 \textcolor{stringliteral}{    This functions is to generate login hash block with devid}
384 \textcolor{stringliteral}{    :param devid:}
385 \textcolor{stringliteral}{    :param key:}
386 \textcolor{stringliteral}{    :return: login hash block}
387 \textcolor{stringliteral}{    """}
388 
389     \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} devid:
390         \textcolor{keywordflow}{raise} ValueError(\textcolor{stringliteral}{"[info:create\_loginhashblock] devid is null"})
391 
392     \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} key:
393         key = \textcolor{stringliteral}{'HKAHJFKIIJF'}
394 
395     length = 8
396     kdf = \textcolor{stringliteral}{'pbkdf2'}
397     salt = \hyperlink{namespaceloginhashblock_afe116dea3aaff238a5fa2bcd6edf2281}{create\_salt}(length)
398     hash, method = \hyperlink{namespaceloginhashblock_a935d8ae1c51e50f9e5db6a1d5f02b1b8}{create\_hash}(salt, key, kdf=kdf)
399 
400     \textcolor{keywordflow}{if} DEBUG:
401         text = \textcolor{stringliteral}{"[info:create\_loginhashblock] salt: \{\}, method: \{\}, hash: \{\}, devid: \{\}"}.format(salt, method
      , hash, devid)
402         print(text)
403 
404     LHBstr = \textcolor{stringliteral}{'\{\}$\{\}'}.format(devid, hash)
405 
406     \textcolor{keywordflow}{return} LHBstr
407 \end{DoxyCode}


Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceloginhashblock_ad3ef8dab740c69ca8424797f9c146a53_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceloginhashblock_ad3ef8dab740c69ca8424797f9c146a53_icgraph}
\end{center}
\end{figure}


\index{loginhashblock@{loginhashblock}!create\+\_\+loginhashblocklist@{create\+\_\+loginhashblocklist}}
\index{create\+\_\+loginhashblocklist@{create\+\_\+loginhashblocklist}!loginhashblock@{loginhashblock}}
\subsubsection[{\texorpdfstring{create\+\_\+loginhashblocklist(\+L\+H\+Blist\+Str, D\+E\+B\+U\+G=\+D\+E\+B\+U\+G)}{create_loginhashblocklist(LHBlistStr, DEBUG=DEBUG)}}]{\setlength{\rightskip}{0pt plus 5cm}def loginhashblock.\+create\+\_\+loginhashblocklist (
\begin{DoxyParamCaption}
\item[{}]{L\+H\+Blist\+Str, }
\item[{}]{D\+E\+B\+UG = {\ttfamily {\bf D\+E\+B\+UG}}}
\end{DoxyParamCaption}
)}\hypertarget{namespaceloginhashblock_a550707107141dfb228ca4294d7ea31b4}{}\label{namespaceloginhashblock_a550707107141dfb228ca4294d7ea31b4}
\begin{DoxyVerb}This function create login hash block list. First of all it generate device id and then it makes login hash block string. Finally it update the login hash block list that was joined with login hash block.
:param LHBlistStr: previous login hash block list
:return:
\end{DoxyVerb}
 

Definition at line 83 of file loginhashblock.\+py.


\begin{DoxyCode}
83 \textcolor{keyword}{def }\hyperlink{namespaceloginhashblock_a550707107141dfb228ca4294d7ea31b4}{create\_loginhashblocklist}(LHBlistStr, DEBUG=DEBUG):
84     \textcolor{stringliteral}{"""}
85 \textcolor{stringliteral}{    This function create login hash block list. First of all it generate device id and then it makes login
       hash block string. Finally it update the login hash block list that was joined with login hash block.}
86 \textcolor{stringliteral}{    :param LHBlistStr: previous login hash block list}
87 \textcolor{stringliteral}{    :return:}
88 \textcolor{stringliteral}{    """}
89 
90     devid = \hyperlink{namespaceloginhashblock_a1bd31fe2f0ea4e6673127d72b6c42826}{create\_deviceId}(DEBUG=DEBUG)
91     LHBstr = \hyperlink{namespaceloginhashblock_ad3ef8dab740c69ca8424797f9c146a53}{create\_loginhashblock}(devid, DEBUG=DEBUG)
92     uLHBlistStr, uLHBstr = \hyperlink{namespaceloginhashblock_a2bcc7ddd0fcc3788572dd77808cb624d}{update\_loginhashblocklist}(LHBlistStr, LHBstr)
93 
94     \textcolor{keywordflow}{return} uLHBlistStr, uLHBstr
95 
\end{DoxyCode}


Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceloginhashblock_a550707107141dfb228ca4294d7ea31b4_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceloginhashblock_a550707107141dfb228ca4294d7ea31b4_icgraph}
\end{center}
\end{figure}


\index{loginhashblock@{loginhashblock}!create\+\_\+salt@{create\+\_\+salt}}
\index{create\+\_\+salt@{create\+\_\+salt}!loginhashblock@{loginhashblock}}
\subsubsection[{\texorpdfstring{create\+\_\+salt(length, R\+A\+N\+D\+\_\+\+C\+H\+A\+R\+S=\+None, D\+E\+B\+U\+G=\+False)}{create_salt(length, RAND_CHARS=None, DEBUG=False)}}]{\setlength{\rightskip}{0pt plus 5cm}def loginhashblock.\+create\+\_\+salt (
\begin{DoxyParamCaption}
\item[{}]{length, }
\item[{}]{R\+A\+N\+D\+\_\+\+C\+H\+A\+RS = {\ttfamily None}, }
\item[{}]{D\+E\+B\+UG = {\ttfamily False}}
\end{DoxyParamCaption}
)}\hypertarget{namespaceloginhashblock_afe116dea3aaff238a5fa2bcd6edf2281}{}\label{namespaceloginhashblock_afe116dea3aaff238a5fa2bcd6edf2281}
\begin{DoxyVerb}This function generate a random string of SALT_CHARS with specified length.
:param length: salt length
:param RAND_CHARS: random chars
:return:
\end{DoxyVerb}
 

Definition at line 66 of file loginhashblock.\+py.


\begin{DoxyCode}
66 \textcolor{keyword}{def }\hyperlink{namespaceloginhashblock_afe116dea3aaff238a5fa2bcd6edf2281}{create\_salt}(length, RAND\_CHARS=None, DEBUG=False):
67     \textcolor{stringliteral}{"""}
68 \textcolor{stringliteral}{    This function generate a random string of SALT\_CHARS with specified length.}
69 \textcolor{stringliteral}{    :param length: salt length}
70 \textcolor{stringliteral}{    :param RAND\_CHARS: random chars}
71 \textcolor{stringliteral}{    :return:}
72 \textcolor{stringliteral}{    """}
73     \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} RAND\_CHARS:
74         RAND\_CHARS = \textcolor{stringliteral}{"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!@#%^&*()"}
75 
76     randx = list()
77     \textcolor{keywordflow}{for} x \textcolor{keywordflow}{in} range(length):
78          randx.append(random.choice(RAND\_CHARS))
79 
80     salt = \textcolor{stringliteral}{''}.join(randx)
81     \textcolor{keywordflow}{return} salt
82 
\end{DoxyCode}


Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceloginhashblock_afe116dea3aaff238a5fa2bcd6edf2281_icgraph}
\end{center}
\end{figure}


\index{loginhashblock@{loginhashblock}!get\+\_\+device\+Id@{get\+\_\+device\+Id}}
\index{get\+\_\+device\+Id@{get\+\_\+device\+Id}!loginhashblock@{loginhashblock}}
\subsubsection[{\texorpdfstring{get\+\_\+device\+Id(\+L\+H\+Bstr, D\+E\+B\+U\+G=\+False)}{get_deviceId(LHBstr, DEBUG=False)}}]{\setlength{\rightskip}{0pt plus 5cm}def loginhashblock.\+get\+\_\+device\+Id (
\begin{DoxyParamCaption}
\item[{}]{L\+H\+Bstr, }
\item[{}]{D\+E\+B\+UG = {\ttfamily False}}
\end{DoxyParamCaption}
)}\hypertarget{namespaceloginhashblock_a17417f2f6bca76ab51170082a562e5f6}{}\label{namespaceloginhashblock_a17417f2f6bca76ab51170082a562e5f6}
\begin{DoxyVerb}This function is to get device id from login hash block. login hash block is on device id and hashblock divided by special characters '$'.
:param LHBstr: string of login hash block
:return:
\end{DoxyVerb}
 

Definition at line 195 of file loginhashblock.\+py.


\begin{DoxyCode}
195 \textcolor{keyword}{def }\hyperlink{namespaceloginhashblock_a17417f2f6bca76ab51170082a562e5f6}{get\_deviceId}(LHBstr, DEBUG=False):
196     \textcolor{stringliteral}{"""}
197 \textcolor{stringliteral}{    This function is to get device id from login hash block. login hash block is on device id and hashblock
       divided by special characters '$'.}
198 \textcolor{stringliteral}{    :param LHBstr: string of login hash block}
199 \textcolor{stringliteral}{    :return:}
200 \textcolor{stringliteral}{    """}
201 
202     \textcolor{keywordflow}{if} DEBUG:
203         print(\textcolor{stringliteral}{"[info:get\_deviceId] LHBstr: \{\}"}.format(LHBstr))
204 
205     \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} LHBstr:
206         \textcolor{keywordflow}{raise} ValueError(\textcolor{stringliteral}{"[info:get\_deviceId] login hash block is null"})
207 
208     \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} \hyperlink{namespaceloginhashblock_adb424539d851426da7b65d53c5a6d577}{valid\_loginhashblock}(LHBstr, DEBUG=DEBUG):
209         \textcolor{keywordflow}{raise} ValueError(\textcolor{stringliteral}{"[info:get\_deviceId] Invalid login hash block"})
210 
211     devid, loginhash = LHBstr.split(\textcolor{stringliteral}{"$"}, 1)
212     \textcolor{keywordflow}{return} devid
213 
\end{DoxyCode}


Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=334pt]{namespaceloginhashblock_a17417f2f6bca76ab51170082a562e5f6_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceloginhashblock_a17417f2f6bca76ab51170082a562e5f6_icgraph}
\end{center}
\end{figure}


\index{loginhashblock@{loginhashblock}!get\+\_\+loginhashblock@{get\+\_\+loginhashblock}}
\index{get\+\_\+loginhashblock@{get\+\_\+loginhashblock}!loginhashblock@{loginhashblock}}
\subsubsection[{\texorpdfstring{get\+\_\+loginhashblock(devid, L\+H\+Blist, D\+E\+B\+U\+G=\+False)}{get_loginhashblock(devid, LHBlist, DEBUG=False)}}]{\setlength{\rightskip}{0pt plus 5cm}def loginhashblock.\+get\+\_\+loginhashblock (
\begin{DoxyParamCaption}
\item[{}]{devid, }
\item[{}]{L\+H\+Blist, }
\item[{}]{D\+E\+B\+UG = {\ttfamily False}}
\end{DoxyParamCaption}
)}\hypertarget{namespaceloginhashblock_a6187961cb9009c7836e7e6e639085f93}{}\label{namespaceloginhashblock_a6187961cb9009c7836e7e6e639085f93}
\begin{DoxyVerb}This function is to get login hash block by device id in login hash block list.
:devid: device id
:LHBlist: client's login has block in database
:return:
\end{DoxyVerb}
 

Definition at line 361 of file loginhashblock.\+py.


\begin{DoxyCode}
361 \textcolor{keyword}{def }\hyperlink{namespaceloginhashblock_a6187961cb9009c7836e7e6e639085f93}{get\_loginhashblock}(devid, LHBlist, DEBUG=False):
362     \textcolor{stringliteral}{"""}
363 \textcolor{stringliteral}{    This function is to get login hash block by device id in login hash block list.}
364 \textcolor{stringliteral}{    :devid: device id}
365 \textcolor{stringliteral}{    :LHBlist: client's login has block in database}
366 \textcolor{stringliteral}{    :return:}
367 \textcolor{stringliteral}{    """}
368 
369     \textcolor{keywordflow}{for} LHBstr \textcolor{keywordflow}{in} LHBlist:
370         \_devid = \hyperlink{namespaceloginhashblock_a17417f2f6bca76ab51170082a562e5f6}{get\_deviceId}(LHBstr, DEBUG=DEBUG)
371         \textcolor{keywordflow}{if} devid == \_devid:
372             \textcolor{keywordflow}{if} DEBUG:
373                 print(\textcolor{stringliteral}{'[info:get\_loginhashblock] devid is found in login hash block list'})
374             \textcolor{keywordflow}{return} LHBstr
375 
376     \textcolor{keywordflow}{if} DEBUG:
377         print(\textcolor{stringliteral}{'[info:get\_loginhashblock] devid is not found in login hash block list'})
378 
379     \textcolor{keywordflow}{return} \textcolor{stringliteral}{''}
380 
\end{DoxyCode}


Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceloginhashblock_a6187961cb9009c7836e7e6e639085f93_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceloginhashblock_a6187961cb9009c7836e7e6e639085f93_icgraph}
\end{center}
\end{figure}


\index{loginhashblock@{loginhashblock}!is\+Registed\+L\+HB@{is\+Registed\+L\+HB}}
\index{is\+Registed\+L\+HB@{is\+Registed\+L\+HB}!loginhashblock@{loginhashblock}}
\subsubsection[{\texorpdfstring{is\+Registed\+L\+H\+B(\+L\+H\+Bstr, L\+H\+Blist\+Str, D\+E\+B\+U\+G=\+False)}{isRegistedLHB(LHBstr, LHBlistStr, DEBUG=False)}}]{\setlength{\rightskip}{0pt plus 5cm}def loginhashblock.\+is\+Registed\+L\+HB (
\begin{DoxyParamCaption}
\item[{}]{L\+H\+Bstr, }
\item[{}]{L\+H\+Blist\+Str, }
\item[{}]{D\+E\+B\+UG = {\ttfamily False}}
\end{DoxyParamCaption}
)}\hypertarget{namespaceloginhashblock_a746d5c48cd93a76b78c90c34419ebdaa}{}\label{namespaceloginhashblock_a746d5c48cd93a76b78c90c34419ebdaa}
\begin{DoxyVerb}This function is to check valid previous login hash block.
:LHBstr: client's login hash block
:LHBlistStr: client's login has block in database
\end{DoxyVerb}
 

Definition at line 338 of file loginhashblock.\+py.


\begin{DoxyCode}
338 \textcolor{keyword}{def }\hyperlink{namespaceloginhashblock_a746d5c48cd93a76b78c90c34419ebdaa}{isRegistedLHB}(LHBstr, LHBlistStr, DEBUG=False):
339     \textcolor{stringliteral}{"""}
340 \textcolor{stringliteral}{    This function is to check valid previous login hash block.}
341 \textcolor{stringliteral}{    :LHBstr: client's login hash block}
342 \textcolor{stringliteral}{    :LHBlistStr: client's login has block in database}
343 \textcolor{stringliteral}{    """}
344 
345     LHBlist = LHBlistStr.split(\textcolor{stringliteral}{','})
346 
347     \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} \hyperlink{namespaceloginhashblock_adb424539d851426da7b65d53c5a6d577}{valid\_loginhashblock}(LHBstr, DEBUG=DEBUG):
348         \textcolor{keywordflow}{return} \textcolor{keyword}{False}
349 
350     devid = \hyperlink{namespaceloginhashblock_a17417f2f6bca76ab51170082a562e5f6}{get\_deviceId}(LHBstr, DEBUG=DEBUG)
351     target\_LHBstr = \hyperlink{namespaceloginhashblock_a6187961cb9009c7836e7e6e639085f93}{get\_loginhashblock}(devid, LHBlist, DEBUG=DEBUG)
352 
353     \textcolor{keywordflow}{if} DEBUG:
354         print(\textcolor{stringliteral}{"[info:isRegistedLHB]\(\backslash\)nclient\_loginhashblock: \{\}\(\backslash\)nserver\_loginhashblock: \{\}"}.format(LHBstr, 
      target\_LHBstr))
355 
356     \textcolor{keywordflow}{if} LHBstr == target\_LHBstr:
357         \textcolor{keywordflow}{return} \textcolor{keyword}{True}
358 
359     \textcolor{keywordflow}{return} \textcolor{keyword}{False}
360 
\end{DoxyCode}


Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceloginhashblock_a746d5c48cd93a76b78c90c34419ebdaa_cgraph}
\end{center}
\end{figure}


\index{loginhashblock@{loginhashblock}!pbkdf2\+\_\+hash@{pbkdf2\+\_\+hash}}
\index{pbkdf2\+\_\+hash@{pbkdf2\+\_\+hash}!loginhashblock@{loginhashblock}}
\subsubsection[{\texorpdfstring{pbkdf2\+\_\+hash(data, salt, iterations, dklen=\+None, hash\+\_\+name=""sha256"", D\+E\+B\+U\+G=\+False)}{pbkdf2_hash(data, salt, iterations, dklen=None, hash_name="sha256", DEBUG=False)}}]{\setlength{\rightskip}{0pt plus 5cm}def loginhashblock.\+pbkdf2\+\_\+hash (
\begin{DoxyParamCaption}
\item[{}]{data, }
\item[{}]{salt, }
\item[{}]{iterations, }
\item[{}]{dklen = {\ttfamily None}, }
\item[{}]{hash\+\_\+name = {\ttfamily \char`\"{}sha256\char`\"{}}, }
\item[{}]{D\+E\+B\+UG = {\ttfamily False}}
\end{DoxyParamCaption}
)}\hypertarget{namespaceloginhashblock_a104d0a92cdfb6c337794b6ded42667d4}{}\label{namespaceloginhashblock_a104d0a92cdfb6c337794b6ded42667d4}
\begin{DoxyVerb}The function generated hash using PKCS#5 password-based key derivation function. It uses HMAC as pseudorandom function and returns the hexadecimal representation of the binary data. Every byte of data is converted into the corresponding 2-digit hex representation.
:param data: data and salt are interpreted as buffers of byte
:param salt: data and salt are interpreted as buffers of byte
:param iterations: The number of iterations should be chosen based on the hash algorithm and computing power. As of 2013, at least 100,000 iterations of SHA-256 are suggested.
:param dklen: dklen is the length of the derived key. If dklen is None then the digest size of the hash algorithm hash_name is used, e.g. 64 for SHA-512.
:param hash_name: hash_name is the desired name of the hash digest algorithm for HMAC(default: sha256)
:return:
\end{DoxyVerb}
 

Definition at line 45 of file loginhashblock.\+py.


\begin{DoxyCode}
45 \textcolor{keyword}{def }\hyperlink{namespaceloginhashblock_a104d0a92cdfb6c337794b6ded42667d4}{pbkdf2\_hash}(data, salt, iterations, dklen=None, hash\_name="sha256", DEBUG=False):
46     \textcolor{stringliteral}{"""}
47 \textcolor{stringliteral}{    The function generated hash using PKCS#5 password-based key derivation function. It uses HMAC as
       pseudorandom function and returns the hexadecimal representation of the binary data. Every byte of data is
       converted into the corresponding 2-digit hex representation.}
48 \textcolor{stringliteral}{    :param data: data and salt are interpreted as buffers of byte}
49 \textcolor{stringliteral}{    :param salt: data and salt are interpreted as buffers of byte}
50 \textcolor{stringliteral}{    :param iterations: The number of iterations should be chosen based on the hash algorithm and computing
       power. As of 2013, at least 100,000 iterations of SHA-256 are suggested.}
51 \textcolor{stringliteral}{    :param dklen: dklen is the length of the derived key. If dklen is None then the digest size of the hash
       algorithm hash\_name is used, e.g. 64 for SHA-512.}
52 \textcolor{stringliteral}{    :param hash\_name: hash\_name is the desired name of the hash digest algorithm for HMAC(default: sha256)}
53 \textcolor{stringliteral}{    :return:}
54 \textcolor{stringliteral}{    """}
55 
56     \textcolor{keywordflow}{if} DEBUG:
57         print(\textcolor{stringliteral}{'[info:pdkdf2\_ascii] hash: '}, hash\_name)
58         print(\textcolor{stringliteral}{'[info:pdkdf2\_ascii] iterations: '}, iterations)
59         print(\textcolor{stringliteral}{'[info:pdkdf2\_ascii] data: '}, data.encode(\textcolor{stringliteral}{'ascii'}))
60         print(\textcolor{stringliteral}{'[info:pdkdf2\_ascii] salt: '}, salt.encode(\textcolor{stringliteral}{'ascii'}))
61 
62     dk = hashlib.pbkdf2\_hmac(hash\_name, data.encode(\textcolor{stringliteral}{'ascii'}), salt.encode(\textcolor{stringliteral}{'ascii'}), iterations, dklen=dklen
      )
63     hex = binascii.hexlify(dk)
64     \textcolor{keywordflow}{return} hex.decode(\textcolor{stringliteral}{'ascii'})
65 
\end{DoxyCode}


Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceloginhashblock_a104d0a92cdfb6c337794b6ded42667d4_icgraph}
\end{center}
\end{figure}


\index{loginhashblock@{loginhashblock}!print\+\_\+\+L\+H\+Blist@{print\+\_\+\+L\+H\+Blist}}
\index{print\+\_\+\+L\+H\+Blist@{print\+\_\+\+L\+H\+Blist}!loginhashblock@{loginhashblock}}
\subsubsection[{\texorpdfstring{print\+\_\+\+L\+H\+Blist(\+L\+H\+Blist\+Str, D\+E\+B\+U\+G=\+False)}{print_LHBlist(LHBlistStr, DEBUG=False)}}]{\setlength{\rightskip}{0pt plus 5cm}def loginhashblock.\+print\+\_\+\+L\+H\+Blist (
\begin{DoxyParamCaption}
\item[{}]{L\+H\+Blist\+Str, }
\item[{}]{D\+E\+B\+UG = {\ttfamily False}}
\end{DoxyParamCaption}
)}\hypertarget{namespaceloginhashblock_a1096aa8494b9c5875decc029d8b40ea9}{}\label{namespaceloginhashblock_a1096aa8494b9c5875decc029d8b40ea9}
\begin{DoxyVerb}a
The function prints login hash block list for debug. if login hash block list length is above 1, login hash block prints line by line.
:param LHBlistStr:
:return:
\end{DoxyVerb}
 

Definition at line 21 of file loginhashblock.\+py.


\begin{DoxyCode}
21 \textcolor{keyword}{def }\hyperlink{namespaceloginhashblock_a1096aa8494b9c5875decc029d8b40ea9}{print\_LHBlist}(LHBlistStr, DEBUG=False):
22     \textcolor{stringliteral}{"""}
23 \textcolor{stringliteral}{    a}
24 \textcolor{stringliteral}{The function prints login hash block list for debug. if login hash block list length is above 1, login hash
       block prints line by line.}
25 \textcolor{stringliteral}{    :param LHBlistStr:}
26 \textcolor{stringliteral}{    :return:}
27 \textcolor{stringliteral}{    """}
28 
29     \textcolor{keywordflow}{if} LHBlistStr == \textcolor{keywordtype}{None}:
30         text = \textcolor{stringliteral}{'[info:print\_LHBlist] user.Lhashblock:\(\backslash\)n\{\}'}.format(LHBlistStr)
31         \textcolor{keywordflow}{return} \textcolor{keyword}{True}
32 
33     \textcolor{keywordflow}{if} len(LHBlistStr) < 1:
34         text = \textcolor{stringliteral}{'[info:print\_LHBlist] user.Lhashblock:\(\backslash\)n\{\}'}.format(LHBlistStr)
35         print(text)
36     \textcolor{keywordflow}{else}:
37         hblist = LHBlistStr.split(\textcolor{stringliteral}{','})
38         text = \textcolor{stringliteral}{'[info:print\_LHBlist] user.Lhashblock:'}
39         print(text)
40         \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} hblist:
41             print(i)
42 
43     \textcolor{keywordflow}{return} \textcolor{keyword}{True}
44 
\end{DoxyCode}


Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=326pt]{namespaceloginhashblock_a1096aa8494b9c5875decc029d8b40ea9_icgraph}
\end{center}
\end{figure}


\index{loginhashblock@{loginhashblock}!update\+\_\+loginhashblock@{update\+\_\+loginhashblock}}
\index{update\+\_\+loginhashblock@{update\+\_\+loginhashblock}!loginhashblock@{loginhashblock}}
\subsubsection[{\texorpdfstring{update\+\_\+loginhashblock(prev\+L\+H\+Bstr, D\+E\+B\+U\+G=\+False)}{update_loginhashblock(prevLHBstr, DEBUG=False)}}]{\setlength{\rightskip}{0pt plus 5cm}def loginhashblock.\+update\+\_\+loginhashblock (
\begin{DoxyParamCaption}
\item[{}]{prev\+L\+H\+Bstr, }
\item[{}]{D\+E\+B\+UG = {\ttfamily False}}
\end{DoxyParamCaption}
)}\hypertarget{namespaceloginhashblock_afef75d97c834ce0fda711b93d0b56b00}{}\label{namespaceloginhashblock_afef75d97c834ce0fda711b93d0b56b00}
\begin{DoxyVerb}This function is to update login hash block with old login hash block
:param prevLHBstr:
:param DEBUG:
:return: updated login hash block
\end{DoxyVerb}
 

Definition at line 315 of file loginhashblock.\+py.


\begin{DoxyCode}
315 \textcolor{keyword}{def }\hyperlink{namespaceloginhashblock_afef75d97c834ce0fda711b93d0b56b00}{update\_loginhashblock}(prevLHBstr, DEBUG=False):
316     \textcolor{stringliteral}{"""}
317 \textcolor{stringliteral}{    This function is to update login hash block with old login hash block}
318 \textcolor{stringliteral}{    :param prevLHBstr:}
319 \textcolor{stringliteral}{    :param DEBUG:}
320 \textcolor{stringliteral}{    :return: updated login hash block}
321 \textcolor{stringliteral}{    """}
322 
323     \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} prevLHBstr:
324         \textcolor{keywordflow}{return} \textcolor{keywordtype}{None}
325 
326     \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} \hyperlink{namespaceloginhashblock_adb424539d851426da7b65d53c5a6d577}{valid\_loginhashblock}(prevLHBstr, DEBUG=DEBUG):
327         \textcolor{keywordflow}{raise} ValueError(\textcolor{stringliteral}{"[info:update\_loginhashblock] Invalid login hash block"})
328 
329     devid = \hyperlink{namespaceloginhashblock_a17417f2f6bca76ab51170082a562e5f6}{get\_deviceId}(prevLHBstr, DEBUG=DEBUG)
330     LHBstr = \hyperlink{namespaceloginhashblock_ad3ef8dab740c69ca8424797f9c146a53}{create\_loginhashblock}(devid, DEBUG=DEBUG)
331 
332     \textcolor{keywordflow}{if} DEBUG:
333         text = \textcolor{stringliteral}{'[info:update\_loginhashblock] \(\backslash\)npre\_loginhashblock: \{\}\(\backslash\)nnew\_loginhashblock: \{\}'}.format(
      prevLHBstr,LHBstr)
334         print(text)
335 
336     \textcolor{keywordflow}{return} LHBstr
337 
\end{DoxyCode}


Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceloginhashblock_afef75d97c834ce0fda711b93d0b56b00_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceloginhashblock_afef75d97c834ce0fda711b93d0b56b00_icgraph}
\end{center}
\end{figure}


\index{loginhashblock@{loginhashblock}!update\+\_\+loginhashblocklist@{update\+\_\+loginhashblocklist}}
\index{update\+\_\+loginhashblocklist@{update\+\_\+loginhashblocklist}!loginhashblock@{loginhashblock}}
\subsubsection[{\texorpdfstring{update\+\_\+loginhashblocklist(\+L\+H\+Blist\+Str, prev\+L\+H\+Bstr, D\+E\+B\+U\+G=\+False)}{update_loginhashblocklist(LHBlistStr, prevLHBstr, DEBUG=False)}}]{\setlength{\rightskip}{0pt plus 5cm}def loginhashblock.\+update\+\_\+loginhashblocklist (
\begin{DoxyParamCaption}
\item[{}]{L\+H\+Blist\+Str, }
\item[{}]{prev\+L\+H\+Bstr, }
\item[{}]{D\+E\+B\+UG = {\ttfamily False}}
\end{DoxyParamCaption}
)}\hypertarget{namespaceloginhashblock_a2bcc7ddd0fcc3788572dd77808cb624d}{}\label{namespaceloginhashblock_a2bcc7ddd0fcc3788572dd77808cb624d}
\begin{DoxyVerb}This function update login hash block list.
:param LHBlistStr: login hash block list string
:param LHBstr: login hash block
:return:
\end{DoxyVerb}
 

Definition at line 96 of file loginhashblock.\+py.


\begin{DoxyCode}
96 \textcolor{keyword}{def }\hyperlink{namespaceloginhashblock_a2bcc7ddd0fcc3788572dd77808cb624d}{update\_loginhashblocklist}(LHBlistStr, prevLHBstr, DEBUG=False):
97     \textcolor{stringliteral}{"""}
98 \textcolor{stringliteral}{    This function update login hash block list.}
99 \textcolor{stringliteral}{    :param LHBlistStr: login hash block list string}
100 \textcolor{stringliteral}{    :param LHBstr: login hash block}
101 \textcolor{stringliteral}{    :return:}
102 \textcolor{stringliteral}{    """}
103 
104     LHBstr = \hyperlink{namespaceloginhashblock_afef75d97c834ce0fda711b93d0b56b00}{update\_loginhashblock}(prevLHBstr, DEBUG=\textcolor{keyword}{False})
105 
106     \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} LHBstr:
107         \textcolor{keywordflow}{return} LHBlistStr, LHBstr
108 
109     devid = \hyperlink{namespaceloginhashblock_a17417f2f6bca76ab51170082a562e5f6}{get\_deviceId}(LHBstr, DEBUG=DEBUG)
110 
111     \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} LHBlistStr:
112         LHBlistStr = LHBstr
113         
114         \textcolor{keywordflow}{if} DEBUG:
115             print(\textcolor{stringliteral}{"[info:update\_loginhashblocklist] LHBlistStr is null"})
116 
117         \textcolor{keywordflow}{return} LHBlistStr, LHBstr
118 
119     LHBlist = LHBlistStr.split(\textcolor{stringliteral}{','})
120 
121     \textcolor{keywordflow}{for} i,v \textcolor{keywordflow}{in} enumerate(LHBlist):
122         \_devid = \hyperlink{namespaceloginhashblock_a17417f2f6bca76ab51170082a562e5f6}{get\_deviceId}(v, DEBUG=DEBUG)
123         \textcolor{keywordflow}{if} devid == \_devid:
124             LHBlist[i] = LHBstr
125             LHBlistStr = \textcolor{stringliteral}{","}.join(LHBlist)
126             \textcolor{keywordflow}{return} LHBlistStr, LHBstr
127 
128     LHBlist.append(LHBstr)
129 
130     \textcolor{keywordflow}{if} DEBUG:
131         print(\textcolor{stringliteral}{"[info:update\_loginhashblocklist] devid: \{\}"}.format(devid))
132         print(\textcolor{stringliteral}{"[info:update\_loginhashblocklist] db\_hashblock: \{\}"}.format(len(LHBlist)))
133 
134     LHBlistStr = \textcolor{stringliteral}{","}.join(LHBlist)
135 
136     \textcolor{keywordflow}{return} LHBlistStr, LHBstr
137 
\end{DoxyCode}


Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceloginhashblock_a2bcc7ddd0fcc3788572dd77808cb624d_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceloginhashblock_a2bcc7ddd0fcc3788572dd77808cb624d_icgraph}
\end{center}
\end{figure}


\index{loginhashblock@{loginhashblock}!valid\+\_\+hash@{valid\+\_\+hash}}
\index{valid\+\_\+hash@{valid\+\_\+hash}!loginhashblock@{loginhashblock}}
\subsubsection[{\texorpdfstring{valid\+\_\+hash(target\+\_\+hash, salt, target, method, D\+E\+B\+U\+G=\+False)}{valid_hash(target_hash, salt, target, method, DEBUG=False)}}]{\setlength{\rightskip}{0pt plus 5cm}def loginhashblock.\+valid\+\_\+hash (
\begin{DoxyParamCaption}
\item[{}]{target\+\_\+hash, }
\item[{}]{salt, }
\item[{}]{target, }
\item[{}]{method, }
\item[{}]{D\+E\+B\+UG = {\ttfamily False}}
\end{DoxyParamCaption}
)}\hypertarget{namespaceloginhashblock_ac7faa165bc305e611390727f11946424}{}\label{namespaceloginhashblock_ac7faa165bc305e611390727f11946424}
\begin{DoxyVerb}This function is to check hash block
:param target_hash:
:param salt:
:param target:
:param method:
:return:
\end{DoxyVerb}
 

Definition at line 171 of file loginhashblock.\+py.


\begin{DoxyCode}
171 \textcolor{keyword}{def }\hyperlink{namespaceloginhashblock_ac7faa165bc305e611390727f11946424}{valid\_hash}(target\_hash, salt, target, method, DEBUG=False):
172     \textcolor{stringliteral}{"""}
173 \textcolor{stringliteral}{    This function is to check hash block}
174 \textcolor{stringliteral}{    :param target\_hash:}
175 \textcolor{stringliteral}{    :param salt:}
176 \textcolor{stringliteral}{    :param target:}
177 \textcolor{stringliteral}{    :param method:}
178 \textcolor{stringliteral}{    :return:}
179 \textcolor{stringliteral}{    """}
180 
181     \textcolor{keywordflow}{if} method.count(\textcolor{stringliteral}{":"}) != 2:
182         \textcolor{keywordflow}{return} \textcolor{keyword}{False}
183 
184     kdf, hash\_name, iterations = method.split(\textcolor{stringliteral}{":"}, 2)
185     hash, method = \hyperlink{namespaceloginhashblock_a935d8ae1c51e50f9e5db6a1d5f02b1b8}{create\_hash}(salt, target, hash\_name=hash\_name, iterations=int(iterations), 
      kdf=kdf)
186     ret = \hyperlink{namespaceloginhashblock_ac24dd842eb90e0ede55e842d44148d5b}{compare\_loginhashblock}(hash, target\_hash)
187 
188     \textcolor{keywordflow}{if} DEBUG:
189         print(\textcolor{stringliteral}{"[info:valid\_hash]        hash: "}, hash)
190         print(\textcolor{stringliteral}{"[info:valid\_hash] target\_hash: "}, target\_hash)
191         print(\textcolor{stringliteral}{"[info:valid\_hash]         ret: "}, ret)
192 
193     \textcolor{keywordflow}{return} ret
194 
\end{DoxyCode}


Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceloginhashblock_ac7faa165bc305e611390727f11946424_cgraph}
\end{center}
\end{figure}


\index{loginhashblock@{loginhashblock}!valid\+\_\+loginhashblock@{valid\+\_\+loginhashblock}}
\index{valid\+\_\+loginhashblock@{valid\+\_\+loginhashblock}!loginhashblock@{loginhashblock}}
\subsubsection[{\texorpdfstring{valid\+\_\+loginhashblock(\+L\+H\+Bstr, D\+E\+B\+U\+G=\+False)}{valid_loginhashblock(LHBstr, DEBUG=False)}}]{\setlength{\rightskip}{0pt plus 5cm}def loginhashblock.\+valid\+\_\+loginhashblock (
\begin{DoxyParamCaption}
\item[{}]{L\+H\+Bstr, }
\item[{}]{D\+E\+B\+UG = {\ttfamily False}}
\end{DoxyParamCaption}
)}\hypertarget{namespaceloginhashblock_adb424539d851426da7b65d53c5a6d577}{}\label{namespaceloginhashblock_adb424539d851426da7b65d53c5a6d577}
\begin{DoxyVerb}This function is to check login hash block
hashblock format: deviceid(8)+$+hash
ex)jUs6LQMX$jUs6LQMX$ceccffbfa52e55825f87573b068c8d759b1540f9833a7d7ebd7a27c993ffd316
:param LHBstr:
:return: BOOL
\end{DoxyVerb}
 

Definition at line 282 of file loginhashblock.\+py.


\begin{DoxyCode}
282 \textcolor{keyword}{def }\hyperlink{namespaceloginhashblock_adb424539d851426da7b65d53c5a6d577}{valid\_loginhashblock}(LHBstr, DEBUG=False):
283     \textcolor{stringliteral}{"""}
284 \textcolor{stringliteral}{    This function is to check login hash block}
285 \textcolor{stringliteral}{    hashblock format: deviceid(8)+$+hash}
286 \textcolor{stringliteral}{    ex)jUs6LQMX$jUs6LQMX$ceccffbfa52e55825f87573b068c8d759b1540f9833a7d7ebd7a27c993ffd316}
287 \textcolor{stringliteral}{    :param LHBstr:}
288 \textcolor{stringliteral}{    :return: BOOL}
289 \textcolor{stringliteral}{    """}
290     \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} LHBstr:
291         \textcolor{keywordflow}{if} DEBUG:
292             print(\textcolor{stringliteral}{'[info:valid\_loginhashblock] Null'})
293         \textcolor{keywordflow}{return} \textcolor{keyword}{False}
294 
295     \textcolor{keywordflow}{if} LHBstr.count(\textcolor{stringliteral}{"$"}) != 1:
296         \textcolor{keywordflow}{if} DEBUG:
297             print(\textcolor{stringliteral}{'[info:valid\_loginhashblock] Invalid format'})
298         \textcolor{keywordflow}{return} \textcolor{keyword}{False}
299 
300     devid, hash = LHBstr.split(\textcolor{stringliteral}{"$"}, 1)
301 
302     \textcolor{keywordflow}{if} len(devid) != 8:
303         \textcolor{keywordflow}{if} DEBUG:
304             print(\textcolor{stringliteral}{'[info:valid\_loginhashblock] Invalid deviceid'})
305         \textcolor{keywordflow}{return} \textcolor{keyword}{False}
306 
307     \textcolor{keywordflow}{if} len(hash) != 64:
308         \textcolor{keywordflow}{return} \textcolor{keyword}{False}
309 
310     \textcolor{keywordflow}{if} DEBUG:
311         print(\textcolor{stringliteral}{'[info:valid\_loginhashblock] login hash block is valid'})
312 
313     \textcolor{keywordflow}{return} \textcolor{keyword}{True}
314 
\end{DoxyCode}


Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceloginhashblock_adb424539d851426da7b65d53c5a6d577_icgraph}
\end{center}
\end{figure}


\index{loginhashblock@{loginhashblock}!verify\+\_\+loginhashblock@{verify\+\_\+loginhashblock}}
\index{verify\+\_\+loginhashblock@{verify\+\_\+loginhashblock}!loginhashblock@{loginhashblock}}
\subsubsection[{\texorpdfstring{verify\+\_\+loginhashblock(\+L\+H\+Blist\+Str, L\+H\+Bstr, D\+E\+B\+U\+G=\+False)}{verify_loginhashblock(LHBlistStr, LHBstr, DEBUG=False)}}]{\setlength{\rightskip}{0pt plus 5cm}def loginhashblock.\+verify\+\_\+loginhashblock (
\begin{DoxyParamCaption}
\item[{}]{L\+H\+Blist\+Str, }
\item[{}]{L\+H\+Bstr, }
\item[{}]{D\+E\+B\+UG = {\ttfamily False}}
\end{DoxyParamCaption}
)}\hypertarget{namespaceloginhashblock_aa5bb94484a68d0bbebce23b4cfeeb4b7}{}\label{namespaceloginhashblock_aa5bb94484a68d0bbebce23b4cfeeb4b7}
\begin{DoxyVerb}This function verify login hash block in db or not. it parse the device id from input login hash block, and search device id in login hash block list string. if it matched, return True
:param LHBlistStr: login hash block list
:param LHBstr: login hash block
:return:
\end{DoxyVerb}
 

Definition at line 258 of file loginhashblock.\+py.


\begin{DoxyCode}
258 \textcolor{keyword}{def }\hyperlink{namespaceloginhashblock_aa5bb94484a68d0bbebce23b4cfeeb4b7}{verify\_loginhashblock}(LHBlistStr, LHBstr, DEBUG=False):
259     \textcolor{stringliteral}{"""}
260 \textcolor{stringliteral}{    This function verify login hash block in db or not. it parse the device id from input login hash block,
       and search device id in login hash block list string. if it matched, return True}
261 \textcolor{stringliteral}{    :param LHBlistStr: login hash block list}
262 \textcolor{stringliteral}{    :param LHBstr: login hash block}
263 \textcolor{stringliteral}{    :return:}
264 \textcolor{stringliteral}{    """}
265 
266     \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} LHBlistStr :
267         \textcolor{keywordflow}{return} \textcolor{keyword}{False}
268 
269     devid = \hyperlink{namespaceloginhashblock_a17417f2f6bca76ab51170082a562e5f6}{get\_deviceId}(LHBstr, DEBUG=DEBUG)
270     LHBlist = LHBlistStr.split(\textcolor{stringliteral}{','})
271 
272     \textcolor{keywordflow}{for} i,v \textcolor{keywordflow}{in} enumerate(LHBlist):
273         \_devid = \hyperlink{namespaceloginhashblock_a17417f2f6bca76ab51170082a562e5f6}{get\_deviceId}(v, DEBUG=DEBUG)
274         \textcolor{keywordflow}{if} devid == \_devid:
275             \textcolor{keywordflow}{if} v == LHBstr:
276                 \textcolor{keywordflow}{return} \textcolor{keyword}{True}
277             \textcolor{keywordflow}{else}:
278                 \textcolor{keywordflow}{return} \textcolor{keyword}{False}
279 
280     \textcolor{keywordflow}{return} \textcolor{keyword}{False}
281 
\end{DoxyCode}


Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceloginhashblock_aa5bb94484a68d0bbebce23b4cfeeb4b7_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceloginhashblock_aa5bb94484a68d0bbebce23b4cfeeb4b7_icgraph}
\end{center}
\end{figure}




\subsection{Variable Documentation}
\index{loginhashblock@{loginhashblock}!D\+E\+B\+UG@{D\+E\+B\+UG}}
\index{D\+E\+B\+UG@{D\+E\+B\+UG}!loginhashblock@{loginhashblock}}
\subsubsection[{\texorpdfstring{D\+E\+B\+UG}{DEBUG}}]{\setlength{\rightskip}{0pt plus 5cm}bool loginhashblock.\+D\+E\+B\+UG = False}\hypertarget{namespaceloginhashblock_ad198a2ffc3d7bab32167aed00d2f5c65}{}\label{namespaceloginhashblock_ad198a2ffc3d7bab32167aed00d2f5c65}


Definition at line 18 of file loginhashblock.\+py.

