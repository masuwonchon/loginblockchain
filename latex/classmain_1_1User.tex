\hypertarget{classmain_1_1User}{}\doxysection{main.\+User Class Reference}
\label{classmain_1_1User}\index{main.User@{main.User}}


Inheritance diagram for main.\+User\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=218pt]{classmain_1_1User__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for main.\+User\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=218pt]{classmain_1_1User__coll__graph}
\end{center}
\end{figure}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
def \mbox{\hyperlink{classmain_1_1User_af9c811fdcf7871c546a3d2a923ca9e2f}{\+\_\+\+\_\+init\+\_\+\+\_\+}} (self, $\ast$$\ast$kwargs)
\item 
def \mbox{\hyperlink{classmain_1_1User_a0086c67911212cc60a39df0424fff2f8}{password}} (self)
\item 
def \mbox{\hyperlink{classmain_1_1User_a5fac9e642b0afaee7e29ddb94e2f1c3e}{password}} (self, password)
\item 
def \mbox{\hyperlink{classmain_1_1User_a8acfe5aa75f7a958346bcb2d156586d9}{verify\+\_\+password}} (self, \mbox{\hyperlink{classmain_1_1User_a0086c67911212cc60a39df0424fff2f8}{password}})
\item 
def \mbox{\hyperlink{classmain_1_1User_a147049a30fbe51d6192d320aa3ea5409}{verify\+\_\+loginhashblock}} (self, \mbox{\hyperlink{classmain_1_1User_aece6256cb85b54493c6d05185f112716}{Login\+HB}})
\item 
def \mbox{\hyperlink{classmain_1_1User_a8b69af8d948dbe7698c904bf94c6ac21}{get\+\_\+totp\+\_\+uri}} (self)
\item 
def \mbox{\hyperlink{classmain_1_1User_a390f1500b4c2fe34d0ba3cf8d1d54906}{verify\+\_\+totp}} (self, token)
\end{DoxyCompactItemize}
\doxysubsection*{Static Public Attributes}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classmain_1_1User_af213bc1240b634425b1b571d6bccc561}{id}} = db.\+Column(db.\+Integer, primary\+\_\+key=True)
\item 
\mbox{\hyperlink{classmain_1_1User_afc469a49c408f90fb653d979d2669f62}{username}} = db.\+Column(db.\+String(64), \mbox{\hyperlink{classmain_1_1index}{index}}=True)
\item 
\mbox{\hyperlink{classmain_1_1User_a4bd5dd61d9eca670b326c87ec7f79f94}{password\+\_\+hash}} = db.\+Column(db.\+String(128))
\item 
\mbox{\hyperlink{classmain_1_1User_a2a7a2d67099632b248ad93661e9733d2}{otp\+\_\+secret}} = db.\+Column(db.\+String(16))
\item 
\mbox{\hyperlink{classmain_1_1User_aa3b839482f4a293703c22ae82e9c639d}{Lhashblock}} = db.\+Column(db.\+String(128))
\item 
\mbox{\hyperlink{classmain_1_1User_aece6256cb85b54493c6d05185f112716}{Login\+HB}} = str(\mbox{\hyperlink{classmain_1_1User_aa3b839482f4a293703c22ae82e9c639d}{Lhashblock}})
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
\begin{DoxyVerb}User model.\end{DoxyVerb}
 

Definition at line 41 of file main.\+py.



\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classmain_1_1User_af9c811fdcf7871c546a3d2a923ca9e2f}\label{classmain_1_1User_af9c811fdcf7871c546a3d2a923ca9e2f}} 
\index{main.User@{main.User}!\_\_init\_\_@{\_\_init\_\_}}
\index{\_\_init\_\_@{\_\_init\_\_}!main.User@{main.User}}
\doxysubsubsection{\texorpdfstring{\_\_init\_\_()}{\_\_init\_\_()}}
{\footnotesize\ttfamily def main.\+User.\+\_\+\+\_\+init\+\_\+\+\_\+ (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{$\ast$$\ast$}]{kwargs }\end{DoxyParamCaption})}



Definition at line 51 of file main.\+py.


\begin{DoxyCode}{0}
\DoxyCodeLine{51     \textcolor{keyword}{def }\_\_init\_\_(self, **kwargs):}
\DoxyCodeLine{52         super(User, self).\_\_init\_\_(**kwargs)}
\DoxyCodeLine{53         \textcolor{keywordflow}{if} self.otp\_secret \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:}
\DoxyCodeLine{54             \textcolor{comment}{\# generate a random secret}}
\DoxyCodeLine{55             self.otp\_secret = base64.b32encode(os.urandom(10)).decode(\textcolor{stringliteral}{'utf-\/8'})}
\DoxyCodeLine{56 }

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{classmain_1_1User_a8b69af8d948dbe7698c904bf94c6ac21}\label{classmain_1_1User_a8b69af8d948dbe7698c904bf94c6ac21}} 
\index{main.User@{main.User}!get\_totp\_uri@{get\_totp\_uri}}
\index{get\_totp\_uri@{get\_totp\_uri}!main.User@{main.User}}
\doxysubsubsection{\texorpdfstring{get\_totp\_uri()}{get\_totp\_uri()}}
{\footnotesize\ttfamily def main.\+User.\+get\+\_\+totp\+\_\+uri (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}



Definition at line 72 of file main.\+py.


\begin{DoxyCode}{0}
\DoxyCodeLine{72     \textcolor{keyword}{def }get\_totp\_uri(self):}
\DoxyCodeLine{73         \textcolor{keywordflow}{return} \textcolor{stringliteral}{'otpauth://totp/2FA-\/Demo:\{0\}?secret=\{1\}\&issuer=2FA-\/Demo'}.format(self.username, self.otp\_secret)}
\DoxyCodeLine{74 }

\end{DoxyCode}
\mbox{\Hypertarget{classmain_1_1User_a0086c67911212cc60a39df0424fff2f8}\label{classmain_1_1User_a0086c67911212cc60a39df0424fff2f8}} 
\index{main.User@{main.User}!password@{password}}
\index{password@{password}!main.User@{main.User}}
\doxysubsubsection{\texorpdfstring{password()}{password()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily def main.\+User.\+password (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}



Definition at line 58 of file main.\+py.


\begin{DoxyCode}{0}
\DoxyCodeLine{58     \textcolor{keyword}{def }password(self):}
\DoxyCodeLine{59         \textcolor{keywordflow}{raise} AttributeError(\textcolor{stringliteral}{'password is not a readable attribute'})}
\DoxyCodeLine{60 }

\end{DoxyCode}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=329pt]{classmain_1_1User_a0086c67911212cc60a39df0424fff2f8_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classmain_1_1User_a5fac9e642b0afaee7e29ddb94e2f1c3e}\label{classmain_1_1User_a5fac9e642b0afaee7e29ddb94e2f1c3e}} 
\index{main.User@{main.User}!password@{password}}
\index{password@{password}!main.User@{main.User}}
\doxysubsubsection{\texorpdfstring{password()}{password()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily def main.\+User.\+password (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{password }\end{DoxyParamCaption})}



Definition at line 62 of file main.\+py.


\begin{DoxyCode}{0}
\DoxyCodeLine{62     \textcolor{keyword}{def }password(self, password):}
\DoxyCodeLine{63         self.password\_hash = generate\_password\_hash(password)}
\DoxyCodeLine{64 }

\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=329pt]{classmain_1_1User_a5fac9e642b0afaee7e29ddb94e2f1c3e_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classmain_1_1User_a147049a30fbe51d6192d320aa3ea5409}\label{classmain_1_1User_a147049a30fbe51d6192d320aa3ea5409}} 
\index{main.User@{main.User}!verify\_loginhashblock@{verify\_loginhashblock}}
\index{verify\_loginhashblock@{verify\_loginhashblock}!main.User@{main.User}}
\doxysubsubsection{\texorpdfstring{verify\_loginhashblock()}{verify\_loginhashblock()}}
{\footnotesize\ttfamily def main.\+User.\+verify\+\_\+loginhashblock (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{Login\+HB }\end{DoxyParamCaption})}



Definition at line 68 of file main.\+py.


\begin{DoxyCode}{0}
\DoxyCodeLine{68     \textcolor{keyword}{def }\mbox{\hyperlink{namespaceloginhashblock_aa5bb94484a68d0bbebce23b4cfeeb4b7}{verify\_loginhashblock}}(self, LoginHB):}
\DoxyCodeLine{69         loginhashblock = self.Lhashblock.split(\textcolor{stringliteral}{','})}
\DoxyCodeLine{70         \textcolor{keywordflow}{return} \textcolor{keyword}{True}}
\DoxyCodeLine{71 }

\end{DoxyCode}
\mbox{\Hypertarget{classmain_1_1User_a8acfe5aa75f7a958346bcb2d156586d9}\label{classmain_1_1User_a8acfe5aa75f7a958346bcb2d156586d9}} 
\index{main.User@{main.User}!verify\_password@{verify\_password}}
\index{verify\_password@{verify\_password}!main.User@{main.User}}
\doxysubsubsection{\texorpdfstring{verify\_password()}{verify\_password()}}
{\footnotesize\ttfamily def main.\+User.\+verify\+\_\+password (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{password }\end{DoxyParamCaption})}



Definition at line 65 of file main.\+py.


\begin{DoxyCode}{0}
\DoxyCodeLine{65     \textcolor{keyword}{def }verify\_password(self, password):}
\DoxyCodeLine{66         \textcolor{keywordflow}{return} check\_password\_hash(self.password\_hash, password)}
\DoxyCodeLine{67 }

\end{DoxyCode}
\mbox{\Hypertarget{classmain_1_1User_a390f1500b4c2fe34d0ba3cf8d1d54906}\label{classmain_1_1User_a390f1500b4c2fe34d0ba3cf8d1d54906}} 
\index{main.User@{main.User}!verify\_totp@{verify\_totp}}
\index{verify\_totp@{verify\_totp}!main.User@{main.User}}
\doxysubsubsection{\texorpdfstring{verify\_totp()}{verify\_totp()}}
{\footnotesize\ttfamily def main.\+User.\+verify\+\_\+totp (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{token }\end{DoxyParamCaption})}



Definition at line 75 of file main.\+py.


\begin{DoxyCode}{0}
\DoxyCodeLine{75     \textcolor{keyword}{def }verify\_totp(self, token):}
\DoxyCodeLine{76         \textcolor{keywordflow}{return} onetimepass.valid\_totp(token, self.otp\_secret)}
\DoxyCodeLine{77 }
\DoxyCodeLine{78 @lm.user\_loader}

\end{DoxyCode}


\doxysubsection{Member Data Documentation}
\mbox{\Hypertarget{classmain_1_1User_af213bc1240b634425b1b571d6bccc561}\label{classmain_1_1User_af213bc1240b634425b1b571d6bccc561}} 
\index{main.User@{main.User}!id@{id}}
\index{id@{id}!main.User@{main.User}}
\doxysubsubsection{\texorpdfstring{id}{id}}
{\footnotesize\ttfamily main.\+User.\+id = db.\+Column(db.\+Integer, primary\+\_\+key=True)\hspace{0.3cm}{\ttfamily [static]}}



Definition at line 44 of file main.\+py.

\mbox{\Hypertarget{classmain_1_1User_aa3b839482f4a293703c22ae82e9c639d}\label{classmain_1_1User_aa3b839482f4a293703c22ae82e9c639d}} 
\index{main.User@{main.User}!Lhashblock@{Lhashblock}}
\index{Lhashblock@{Lhashblock}!main.User@{main.User}}
\doxysubsubsection{\texorpdfstring{Lhashblock}{Lhashblock}}
{\footnotesize\ttfamily main.\+User.\+Lhashblock = db.\+Column(db.\+String(128))\hspace{0.3cm}{\ttfamily [static]}}



Definition at line 48 of file main.\+py.

\mbox{\Hypertarget{classmain_1_1User_aece6256cb85b54493c6d05185f112716}\label{classmain_1_1User_aece6256cb85b54493c6d05185f112716}} 
\index{main.User@{main.User}!LoginHB@{LoginHB}}
\index{LoginHB@{LoginHB}!main.User@{main.User}}
\doxysubsubsection{\texorpdfstring{LoginHB}{LoginHB}}
{\footnotesize\ttfamily main.\+User.\+Login\+HB = str(\mbox{\hyperlink{classmain_1_1User_aa3b839482f4a293703c22ae82e9c639d}{Lhashblock}})\hspace{0.3cm}{\ttfamily [static]}}



Definition at line 49 of file main.\+py.

\mbox{\Hypertarget{classmain_1_1User_a2a7a2d67099632b248ad93661e9733d2}\label{classmain_1_1User_a2a7a2d67099632b248ad93661e9733d2}} 
\index{main.User@{main.User}!otp\_secret@{otp\_secret}}
\index{otp\_secret@{otp\_secret}!main.User@{main.User}}
\doxysubsubsection{\texorpdfstring{otp\_secret}{otp\_secret}}
{\footnotesize\ttfamily main.\+User.\+otp\+\_\+secret = db.\+Column(db.\+String(16))\hspace{0.3cm}{\ttfamily [static]}}



Definition at line 47 of file main.\+py.

\mbox{\Hypertarget{classmain_1_1User_a4bd5dd61d9eca670b326c87ec7f79f94}\label{classmain_1_1User_a4bd5dd61d9eca670b326c87ec7f79f94}} 
\index{main.User@{main.User}!password\_hash@{password\_hash}}
\index{password\_hash@{password\_hash}!main.User@{main.User}}
\doxysubsubsection{\texorpdfstring{password\_hash}{password\_hash}}
{\footnotesize\ttfamily main.\+User.\+password\+\_\+hash = db.\+Column(db.\+String(128))\hspace{0.3cm}{\ttfamily [static]}}



Definition at line 46 of file main.\+py.

\mbox{\Hypertarget{classmain_1_1User_afc469a49c408f90fb653d979d2669f62}\label{classmain_1_1User_afc469a49c408f90fb653d979d2669f62}} 
\index{main.User@{main.User}!username@{username}}
\index{username@{username}!main.User@{main.User}}
\doxysubsubsection{\texorpdfstring{username}{username}}
{\footnotesize\ttfamily main.\+User.\+username = db.\+Column(db.\+String(64), \mbox{\hyperlink{classmain_1_1index}{index}}=True)\hspace{0.3cm}{\ttfamily [static]}}



Definition at line 45 of file main.\+py.



The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
example/\mbox{\hyperlink{main_8py}{main.\+py}}\end{DoxyCompactItemize}
