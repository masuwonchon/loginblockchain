\hypertarget{namespaceloginhashblock}{}\section{loginhashblock Namespace Reference}
\label{namespaceloginhashblock}\index{loginhashblock@{loginhashblock}}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
def \hyperlink{namespaceloginhashblock_af47615d0e87d554eae9e6d49131fe49c}{print\+\_\+\+L\+H\+Blist} (L\+H\+Bliststr, \hyperlink{namespaceloginhashblock_ad198a2ffc3d7bab32167aed00d2f5c65}{D\+E\+B\+UG}=False)
\item 
def \hyperlink{namespaceloginhashblock_a104d0a92cdfb6c337794b6ded42667d4}{pbkdf2\+\_\+hash} (data, salt, iterations, dklen=None, hash\+\_\+name=\char`\"{}sha256\char`\"{}, D\+E\+B\+UG=False)
\item 
def \hyperlink{namespaceloginhashblock_afe116dea3aaff238a5fa2bcd6edf2281}{create\+\_\+salt} (length, R\+A\+N\+D\+\_\+\+C\+H\+A\+RS=None, \hyperlink{namespaceloginhashblock_ad198a2ffc3d7bab32167aed00d2f5c65}{D\+E\+B\+UG}=False)
\item 
def \hyperlink{namespaceloginhashblock_ab3608ba58ffedb0bd8bba86ce71fdefe}{create\+\_\+loginhashblocklist} (prev\+\_\+\+L\+H\+Blist\+Str, \hyperlink{namespaceloginhashblock_ad198a2ffc3d7bab32167aed00d2f5c65}{D\+E\+B\+UG}=\hyperlink{namespaceloginhashblock_ad198a2ffc3d7bab32167aed00d2f5c65}{D\+E\+B\+UG})
\item 
def \hyperlink{namespaceloginhashblock_a7baa4021b9f57044f8227c2e0320ee2b}{update\+\_\+loginhashblocklist} (L\+H\+Blist\+Str, prev\+\_\+\+L\+HB, \hyperlink{namespaceloginhashblock_ad198a2ffc3d7bab32167aed00d2f5c65}{D\+E\+B\+UG}=False)
\item 
def \hyperlink{namespaceloginhashblock_a935d8ae1c51e50f9e5db6a1d5f02b1b8}{create\+\_\+hash} (salt, target, hash\+\_\+name=\char`\"{}sha256\char`\"{}, iterations=100000, kdf=None, \hyperlink{namespaceloginhashblock_ad198a2ffc3d7bab32167aed00d2f5c65}{D\+E\+B\+UG}=False)
\item 
def \hyperlink{namespaceloginhashblock_ac7faa165bc305e611390727f11946424}{valid\+\_\+hash} (target\+\_\+hash, salt, target, method, \hyperlink{namespaceloginhashblock_ad198a2ffc3d7bab32167aed00d2f5c65}{D\+E\+B\+UG}=False)
\item 
def \hyperlink{namespaceloginhashblock_a1908d7c90a7ea1a7f84eeac3a1378b57}{get\+\_\+device\+Id} (loginhashblock, \hyperlink{namespaceloginhashblock_ad198a2ffc3d7bab32167aed00d2f5c65}{D\+E\+B\+UG}=False)
\item 
def \hyperlink{namespaceloginhashblock_a1bd31fe2f0ea4e6673127d72b6c42826}{create\+\_\+device\+Id} (\hyperlink{namespaceloginhashblock_ad198a2ffc3d7bab32167aed00d2f5c65}{D\+E\+B\+UG}=False)
\item 
def \hyperlink{namespaceloginhashblock_ac24dd842eb90e0ede55e842d44148d5b}{compare\+\_\+loginhashblock} (a, b, \hyperlink{namespaceloginhashblock_ad198a2ffc3d7bab32167aed00d2f5c65}{D\+E\+B\+UG}=False)
\item 
def \hyperlink{namespaceloginhashblock_ac120dd8384bd51c357e2ad5f6cb2f99a}{valid\+\_\+loginhashblock} (loginhashblock, \hyperlink{namespaceloginhashblock_ad198a2ffc3d7bab32167aed00d2f5c65}{D\+E\+B\+UG}=False)
\item 
def \hyperlink{namespaceloginhashblock_ab6bafe3dab103cc698822367e53d4a64}{update\+\_\+loginhashblock} (prev\+\_\+loginhashblock, \hyperlink{namespaceloginhashblock_ad198a2ffc3d7bab32167aed00d2f5c65}{D\+E\+B\+UG}=False)
\item 
def \hyperlink{namespaceloginhashblock_a978cb4557443cefddac883f3d92ad8e1}{is\+Registed\+L\+HB} (client\+\_\+loginhashblock, L\+H\+Bliststr, \hyperlink{namespaceloginhashblock_ad198a2ffc3d7bab32167aed00d2f5c65}{D\+E\+B\+UG}=False)
\item 
def \hyperlink{namespaceloginhashblock_ab2ceb1d30aad9af290ac7d44e9f95bf2}{get\+\_\+loginhashblock} (devid, loginhashblocklist, \hyperlink{namespaceloginhashblock_ad198a2ffc3d7bab32167aed00d2f5c65}{D\+E\+B\+UG}=False)
\item 
def \hyperlink{namespaceloginhashblock_ad3ef8dab740c69ca8424797f9c146a53}{create\+\_\+loginhashblock} (devid, key=None, \hyperlink{namespaceloginhashblock_ad198a2ffc3d7bab32167aed00d2f5c65}{D\+E\+B\+UG}=False)
\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
bool \hyperlink{namespaceloginhashblock_ad198a2ffc3d7bab32167aed00d2f5c65}{D\+E\+B\+UG} = False
\end{DoxyCompactItemize}


\subsection{Detailed Description}
\begin{DoxyVerb}LHB(login hash block) module is designed to work for account taker over attack - HMAC-based and PBKDF2 algorithms based.
It is compatible with python flask and application based on it

@version: 1.0.0
@authour: suwonchon(suwonchon@gmail.com)
@contact http://github.com/masuwonchon/loginblockchain
@license: MIT

Example usage:\end{DoxyVerb}
 

\subsection{Function Documentation}
\index{loginhashblock@{loginhashblock}!compare\+\_\+loginhashblock@{compare\+\_\+loginhashblock}}
\index{compare\+\_\+loginhashblock@{compare\+\_\+loginhashblock}!loginhashblock@{loginhashblock}}
\subsubsection[{\texorpdfstring{compare\+\_\+loginhashblock(a, b, D\+E\+B\+U\+G=\+False)}{compare_loginhashblock(a, b, DEBUG=False)}}]{\setlength{\rightskip}{0pt plus 5cm}def loginhashblock.\+compare\+\_\+loginhashblock (
\begin{DoxyParamCaption}
\item[{}]{a, }
\item[{}]{b, }
\item[{}]{D\+E\+B\+UG = {\ttfamily False}}
\end{DoxyParamCaption}
)}\hypertarget{namespaceloginhashblock_ac24dd842eb90e0ede55e842d44148d5b}{}\label{namespaceloginhashblock_ac24dd842eb90e0ede55e842d44148d5b}
\begin{DoxyVerb}This function compare two LHB in Python to check if they are identical.
:param a: compare login hash block
:param b: compare login hash block
:param DEBUG:
:return: BOOL
\end{DoxyVerb}
 

Definition at line 223 of file loginhashblock.\+py.


\begin{DoxyCode}
223 \textcolor{keyword}{def }\hyperlink{namespaceloginhashblock_ac24dd842eb90e0ede55e842d44148d5b}{compare\_loginhashblock}(a, b, DEBUG=False):
224     \textcolor{stringliteral}{"""}
225 \textcolor{stringliteral}{    This function compare two LHB in Python to check if they are identical.}
226 \textcolor{stringliteral}{    :param a: compare login hash block}
227 \textcolor{stringliteral}{    :param b: compare login hash block}
228 \textcolor{stringliteral}{    :param DEBUG:}
229 \textcolor{stringliteral}{    :return: BOOL}
230 \textcolor{stringliteral}{    """}
231 
232     \textcolor{keywordflow}{if} DEBUG:
233         print(\textcolor{stringliteral}{"[info:compare\_loginhashblock] a: "},a)
234         print(\textcolor{stringliteral}{"[info:compare\_loginhashblock] b: "},b)
235 
236     \textcolor{keywordflow}{if} isinstance(a, str):
237         a = a.encode(\textcolor{stringliteral}{"utf-8"})
238 
239     \textcolor{keywordflow}{if} isinstance(b, str):
240         b = b.encode(\textcolor{stringliteral}{"utf-8"})
241 
242     \textcolor{keywordflow}{if} len(a) != len(b):
243         \textcolor{keywordflow}{return} \textcolor{keyword}{False}
244 
245     \textcolor{keywordflow}{for} x, y \textcolor{keywordflow}{in} zip(a, b):
246         \textcolor{keywordflow}{if} x != y:
247             \textcolor{keywordflow}{return} \textcolor{keyword}{False}
248 
249     \textcolor{keywordflow}{return} \textcolor{keyword}{True}
250 
\end{DoxyCode}


Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceloginhashblock_ac24dd842eb90e0ede55e842d44148d5b_icgraph}
\end{center}
\end{figure}


\index{loginhashblock@{loginhashblock}!create\+\_\+device\+Id@{create\+\_\+device\+Id}}
\index{create\+\_\+device\+Id@{create\+\_\+device\+Id}!loginhashblock@{loginhashblock}}
\subsubsection[{\texorpdfstring{create\+\_\+device\+Id(\+D\+E\+B\+U\+G=\+False)}{create_deviceId(DEBUG=False)}}]{\setlength{\rightskip}{0pt plus 5cm}def loginhashblock.\+create\+\_\+device\+Id (
\begin{DoxyParamCaption}
\item[{}]{D\+E\+B\+UG = {\ttfamily False}}
\end{DoxyParamCaption}
)}\hypertarget{namespaceloginhashblock_a1bd31fe2f0ea4e6673127d72b6c42826}{}\label{namespaceloginhashblock_a1bd31fe2f0ea4e6673127d72b6c42826}
\begin{DoxyVerb}This function is to make device Id
:param DEBUG:
:return:
\end{DoxyVerb}
 

Definition at line 207 of file loginhashblock.\+py.


\begin{DoxyCode}
207 \textcolor{keyword}{def }\hyperlink{namespaceloginhashblock_a1bd31fe2f0ea4e6673127d72b6c42826}{create\_deviceId}(DEBUG=False):
208     \textcolor{stringliteral}{"""}
209 \textcolor{stringliteral}{    This function is to make device Id}
210 \textcolor{stringliteral}{    :param DEBUG:}
211 \textcolor{stringliteral}{    :return:}
212 \textcolor{stringliteral}{    """}
213 
214     RAND\_CHARS = \textcolor{stringliteral}{"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789"}
215     devid = \hyperlink{namespaceloginhashblock_afe116dea3aaff238a5fa2bcd6edf2281}{create\_salt}(8, RAND\_CHARS=RAND\_CHARS)
216 
217     \textcolor{keywordflow}{if} DEBUG:
218         text = \textcolor{stringliteral}{"[info:create\_deviceId] devid: \{\}"}.format(devid)
219         print(text)
220 
221     \textcolor{keywordflow}{return} devid
222 
\end{DoxyCode}


Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceloginhashblock_a1bd31fe2f0ea4e6673127d72b6c42826_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceloginhashblock_a1bd31fe2f0ea4e6673127d72b6c42826_icgraph}
\end{center}
\end{figure}


\index{loginhashblock@{loginhashblock}!create\+\_\+hash@{create\+\_\+hash}}
\index{create\+\_\+hash@{create\+\_\+hash}!loginhashblock@{loginhashblock}}
\subsubsection[{\texorpdfstring{create\+\_\+hash(salt, target, hash\+\_\+name=""sha256"", iterations=100000, kdf=\+None, D\+E\+B\+U\+G=\+False)}{create_hash(salt, target, hash_name="sha256", iterations=100000, kdf=None, DEBUG=False)}}]{\setlength{\rightskip}{0pt plus 5cm}def loginhashblock.\+create\+\_\+hash (
\begin{DoxyParamCaption}
\item[{}]{salt, }
\item[{}]{target, }
\item[{}]{hash\+\_\+name = {\ttfamily \char`\"{}sha256\char`\"{}}, }
\item[{}]{iterations = {\ttfamily 100000}, }
\item[{}]{kdf = {\ttfamily None}, }
\item[{}]{D\+E\+B\+UG = {\ttfamily False}}
\end{DoxyParamCaption}
)}\hypertarget{namespaceloginhashblock_a935d8ae1c51e50f9e5db6a1d5f02b1b8}{}\label{namespaceloginhashblock_a935d8ae1c51e50f9e5db6a1d5f02b1b8}
\begin{DoxyVerb}This function is to obtain the digest of the byte target string, It uses HMAC as pseudorandom function.
:param salt, target: Target and salt are interpreted as buffers of bytes.
:param hash_name: The string hash_name is the desired name of the hash digest algorithm for HMAC
:param iterations: The number of iterations should be chosen based on the hash algorithm and computing power. As of 2013, at least 100,000 iterations of SHA-256 are suggested.
:param kdf: key derivation function(ex, bcrypt, PBKDF2 etc)
:return: hash, method
\end{DoxyVerb}
 

Definition at line 130 of file loginhashblock.\+py.


\begin{DoxyCode}
130 \textcolor{keyword}{def }\hyperlink{namespaceloginhashblock_a935d8ae1c51e50f9e5db6a1d5f02b1b8}{create\_hash}(salt, target, hash\_name="sha256", iterations=100000, kdf=None, DEBUG=False):
131     \textcolor{stringliteral}{"""}
132 \textcolor{stringliteral}{    This function is to obtain the digest of the byte target string, It uses HMAC as pseudorandom function.}
133 \textcolor{stringliteral}{    :param salt, target: Target and salt are interpreted as buffers of bytes.}
134 \textcolor{stringliteral}{    :param hash\_name: The string hash\_name is the desired name of the hash digest algorithm for HMAC}
135 \textcolor{stringliteral}{    :param iterations: The number of iterations should be chosen based on the hash algorithm and computing
       power. As of 2013, at least 100,000 iterations of SHA-256 are suggested.}
136 \textcolor{stringliteral}{    :param kdf: key derivation function(ex, bcrypt, PBKDF2 etc)}
137 \textcolor{stringliteral}{    :return: hash, method}
138 \textcolor{stringliteral}{    """}
139 
140     \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} target \textcolor{keywordflow}{or} \textcolor{keywordflow}{not} salt:
141         \textcolor{keywordflow}{raise} ValueError(\textcolor{stringliteral}{"[info:create\_hash] target string or salt is null"})
142 
143     \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} kdf:
144         h = hashlib.new(hash\_name)
145         h.update(target.encode(\textcolor{stringliteral}{'ascii'}))
146         hash = h.hexdigest()
147         method = \textcolor{stringliteral}{"none:%s:%d"} % (hash\_name, iterations)
148     \textcolor{keywordflow}{else}:
149         \textcolor{keywordflow}{if} kdf == \textcolor{stringliteral}{"pbkdf2"}:
150             hash = \hyperlink{namespaceloginhashblock_a104d0a92cdfb6c337794b6ded42667d4}{pbkdf2\_hash}(target, salt, iterations, hash\_name=hash\_name)
151             method = \textcolor{stringliteral}{"pbkdf2:%s:%d"} % (hash\_name, iterations)
152         \textcolor{keywordflow}{elif} kdf == \textcolor{stringliteral}{"scrypt"}:
153             \textcolor{keywordflow}{raise} ValueError(\textcolor{stringliteral}{"[info:create\_hash] will be supported"})
154         \textcolor{keywordflow}{else}:
155             \textcolor{keywordflow}{raise} ValueError(\textcolor{stringliteral}{"[info:create\_hash] Invalid support key derivation function"})
156 
157     \textcolor{keywordflow}{if} DEBUG:
158         text = \textcolor{stringliteral}{"[info:create\_hash] hash: \{\}, method: \{\}"}.format(hash, method)
159         print(text)
160 
161     \textcolor{keywordflow}{return} hash, method
162 
\end{DoxyCode}


Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceloginhashblock_a935d8ae1c51e50f9e5db6a1d5f02b1b8_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceloginhashblock_a935d8ae1c51e50f9e5db6a1d5f02b1b8_icgraph}
\end{center}
\end{figure}


\index{loginhashblock@{loginhashblock}!create\+\_\+loginhashblock@{create\+\_\+loginhashblock}}
\index{create\+\_\+loginhashblock@{create\+\_\+loginhashblock}!loginhashblock@{loginhashblock}}
\subsubsection[{\texorpdfstring{create\+\_\+loginhashblock(devid, key=\+None, D\+E\+B\+U\+G=\+False)}{create_loginhashblock(devid, key=None, DEBUG=False)}}]{\setlength{\rightskip}{0pt plus 5cm}def loginhashblock.\+create\+\_\+loginhashblock (
\begin{DoxyParamCaption}
\item[{}]{devid, }
\item[{}]{key = {\ttfamily None}, }
\item[{}]{D\+E\+B\+UG = {\ttfamily False}}
\end{DoxyParamCaption}
)}\hypertarget{namespaceloginhashblock_ad3ef8dab740c69ca8424797f9c146a53}{}\label{namespaceloginhashblock_ad3ef8dab740c69ca8424797f9c146a53}
\begin{DoxyVerb}This functions is to generate login hash block with devid
:param devid:
:param key:
:param DEBUG:
:return: login hash block
\end{DoxyVerb}
 

Definition at line 347 of file loginhashblock.\+py.


\begin{DoxyCode}
347 \textcolor{keyword}{def }\hyperlink{namespaceloginhashblock_ad3ef8dab740c69ca8424797f9c146a53}{create\_loginhashblock}(devid, key=None, DEBUG=False):
348     \textcolor{stringliteral}{"""}
349 \textcolor{stringliteral}{    This functions is to generate login hash block with devid}
350 \textcolor{stringliteral}{    :param devid:}
351 \textcolor{stringliteral}{    :param key:}
352 \textcolor{stringliteral}{    :param DEBUG:}
353 \textcolor{stringliteral}{    :return: login hash block}
354 \textcolor{stringliteral}{    """}
355 
356     \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} devid:
357         \textcolor{keywordflow}{raise} ValueError(\textcolor{stringliteral}{"[info:create\_loginhashblock] devid is null"})
358 
359     \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} key:
360         key = \textcolor{stringliteral}{'HKAHJFKIIJF'}
361 
362     length = 8
363     kdf = \textcolor{stringliteral}{'pbkdf2'}
364     salt = \hyperlink{namespaceloginhashblock_afe116dea3aaff238a5fa2bcd6edf2281}{create\_salt}(length)
365     hash, method = \hyperlink{namespaceloginhashblock_a935d8ae1c51e50f9e5db6a1d5f02b1b8}{create\_hash}(salt, key, kdf=kdf)
366 
367     \textcolor{keywordflow}{if} DEBUG:
368         text = \textcolor{stringliteral}{"[info:create\_loginhashblock] salt: \{\}, method: \{\}, hash: \{\}, devid: \{\}"}.format(salt, method
      , hash, devid)
369         print(text)
370 
371     loginhashblock = \textcolor{stringliteral}{'\{\}$\{\}'}.format(devid, hash)
372 
373     \textcolor{keywordflow}{return} loginhashblock
374 \end{DoxyCode}


Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceloginhashblock_ad3ef8dab740c69ca8424797f9c146a53_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceloginhashblock_ad3ef8dab740c69ca8424797f9c146a53_icgraph}
\end{center}
\end{figure}


\index{loginhashblock@{loginhashblock}!create\+\_\+loginhashblocklist@{create\+\_\+loginhashblocklist}}
\index{create\+\_\+loginhashblocklist@{create\+\_\+loginhashblocklist}!loginhashblock@{loginhashblock}}
\subsubsection[{\texorpdfstring{create\+\_\+loginhashblocklist(prev\+\_\+\+L\+H\+Blist\+Str, D\+E\+B\+U\+G=\+D\+E\+B\+U\+G)}{create_loginhashblocklist(prev_LHBlistStr, DEBUG=DEBUG)}}]{\setlength{\rightskip}{0pt plus 5cm}def loginhashblock.\+create\+\_\+loginhashblocklist (
\begin{DoxyParamCaption}
\item[{}]{prev\+\_\+\+L\+H\+Blist\+Str, }
\item[{}]{D\+E\+B\+UG = {\ttfamily {\bf D\+E\+B\+UG}}}
\end{DoxyParamCaption}
)}\hypertarget{namespaceloginhashblock_ab3608ba58ffedb0bd8bba86ce71fdefe}{}\label{namespaceloginhashblock_ab3608ba58ffedb0bd8bba86ce71fdefe}


Definition at line 85 of file loginhashblock.\+py.


\begin{DoxyCode}
85 \textcolor{keyword}{def }\hyperlink{namespaceloginhashblock_ab3608ba58ffedb0bd8bba86ce71fdefe}{create\_loginhashblocklist}(prev\_LHBlistStr, DEBUG=DEBUG):
86 
87     devid = \hyperlink{namespaceloginhashblock_a1bd31fe2f0ea4e6673127d72b6c42826}{create\_deviceId}(DEBUG=DEBUG)
88     LHB = \hyperlink{namespaceloginhashblock_ad3ef8dab740c69ca8424797f9c146a53}{create\_loginhashblock}(devid, DEBUG=DEBUG)
89     LHBlistStr = \hyperlink{namespaceloginhashblock_a7baa4021b9f57044f8227c2e0320ee2b}{update\_loginhashblocklist}(prev\_LHBlistStr, LHB)
90 
91     \textcolor{keywordflow}{return} LHBlistStr
92 
\end{DoxyCode}


Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceloginhashblock_ab3608ba58ffedb0bd8bba86ce71fdefe_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceloginhashblock_ab3608ba58ffedb0bd8bba86ce71fdefe_icgraph}
\end{center}
\end{figure}


\index{loginhashblock@{loginhashblock}!create\+\_\+salt@{create\+\_\+salt}}
\index{create\+\_\+salt@{create\+\_\+salt}!loginhashblock@{loginhashblock}}
\subsubsection[{\texorpdfstring{create\+\_\+salt(length, R\+A\+N\+D\+\_\+\+C\+H\+A\+R\+S=\+None, D\+E\+B\+U\+G=\+False)}{create_salt(length, RAND_CHARS=None, DEBUG=False)}}]{\setlength{\rightskip}{0pt plus 5cm}def loginhashblock.\+create\+\_\+salt (
\begin{DoxyParamCaption}
\item[{}]{length, }
\item[{}]{R\+A\+N\+D\+\_\+\+C\+H\+A\+RS = {\ttfamily None}, }
\item[{}]{D\+E\+B\+UG = {\ttfamily False}}
\end{DoxyParamCaption}
)}\hypertarget{namespaceloginhashblock_afe116dea3aaff238a5fa2bcd6edf2281}{}\label{namespaceloginhashblock_afe116dea3aaff238a5fa2bcd6edf2281}
\begin{DoxyVerb}This function generate a random string of SALT_CHARS with specified length.
:param length: salt length
:param RAND_CHARS: random chars
:return:
\end{DoxyVerb}
 

Definition at line 68 of file loginhashblock.\+py.


\begin{DoxyCode}
68 \textcolor{keyword}{def }\hyperlink{namespaceloginhashblock_afe116dea3aaff238a5fa2bcd6edf2281}{create\_salt}(length, RAND\_CHARS=None, DEBUG=False):
69     \textcolor{stringliteral}{"""}
70 \textcolor{stringliteral}{    This function generate a random string of SALT\_CHARS with specified length.}
71 \textcolor{stringliteral}{    :param length: salt length}
72 \textcolor{stringliteral}{    :param RAND\_CHARS: random chars}
73 \textcolor{stringliteral}{    :return:}
74 \textcolor{stringliteral}{    """}
75     \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} RAND\_CHARS:
76         RAND\_CHARS = \textcolor{stringliteral}{"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!@#%^&*()"}
77 
78     randx = list()
79     \textcolor{keywordflow}{for} x \textcolor{keywordflow}{in} range(length):
80          randx.append(random.choice(RAND\_CHARS))
81 
82     salt = \textcolor{stringliteral}{''}.join(randx)
83     \textcolor{keywordflow}{return} salt
84 
\end{DoxyCode}


Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceloginhashblock_afe116dea3aaff238a5fa2bcd6edf2281_icgraph}
\end{center}
\end{figure}


\index{loginhashblock@{loginhashblock}!get\+\_\+device\+Id@{get\+\_\+device\+Id}}
\index{get\+\_\+device\+Id@{get\+\_\+device\+Id}!loginhashblock@{loginhashblock}}
\subsubsection[{\texorpdfstring{get\+\_\+device\+Id(loginhashblock, D\+E\+B\+U\+G=\+False)}{get_deviceId(loginhashblock, DEBUG=False)}}]{\setlength{\rightskip}{0pt plus 5cm}def loginhashblock.\+get\+\_\+device\+Id (
\begin{DoxyParamCaption}
\item[{}]{loginhashblock, }
\item[{}]{D\+E\+B\+UG = {\ttfamily False}}
\end{DoxyParamCaption}
)}\hypertarget{namespaceloginhashblock_a1908d7c90a7ea1a7f84eeac3a1378b57}{}\label{namespaceloginhashblock_a1908d7c90a7ea1a7f84eeac3a1378b57}
\begin{DoxyVerb}This function is to get device id from login hash block
:param hashblock:
:param DEBUG:
:return:
\end{DoxyVerb}
 

Definition at line 187 of file loginhashblock.\+py.


\begin{DoxyCode}
187 \textcolor{keyword}{def }\hyperlink{namespaceloginhashblock_a1908d7c90a7ea1a7f84eeac3a1378b57}{get\_deviceId}(loginhashblock, DEBUG=False):
188     \textcolor{stringliteral}{"""}
189 \textcolor{stringliteral}{    This function is to get device id from login hash block}
190 \textcolor{stringliteral}{    :param hashblock:}
191 \textcolor{stringliteral}{    :param DEBUG:}
192 \textcolor{stringliteral}{    :return:}
193 \textcolor{stringliteral}{    """}
194 
195     \textcolor{keywordflow}{if} DEBUG:
196         print(\textcolor{stringliteral}{"[info:get\_deviceId] loginhashblock: \{\}"}.format(loginhashblock))
197 
198     \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} loginhashblock:
199         \textcolor{keywordflow}{raise} ValueError(\textcolor{stringliteral}{"[info:get\_deviceId] login hash block is null"})
200 
201     \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} \hyperlink{namespaceloginhashblock_ac120dd8384bd51c357e2ad5f6cb2f99a}{valid\_loginhashblock}(loginhashblock, DEBUG=DEBUG):
202         \textcolor{keywordflow}{raise} ValueError(\textcolor{stringliteral}{"[info:get\_deviceId] Invalid login hash block"})
203 
204     devid, loginhash = loginhashblock.split(\textcolor{stringliteral}{"$"}, 1)
205     \textcolor{keywordflow}{return} devid
206 
\end{DoxyCode}


Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=334pt]{namespaceloginhashblock_a1908d7c90a7ea1a7f84eeac3a1378b57_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceloginhashblock_a1908d7c90a7ea1a7f84eeac3a1378b57_icgraph}
\end{center}
\end{figure}


\index{loginhashblock@{loginhashblock}!get\+\_\+loginhashblock@{get\+\_\+loginhashblock}}
\index{get\+\_\+loginhashblock@{get\+\_\+loginhashblock}!loginhashblock@{loginhashblock}}
\subsubsection[{\texorpdfstring{get\+\_\+loginhashblock(devid, loginhashblocklist, D\+E\+B\+U\+G=\+False)}{get_loginhashblock(devid, loginhashblocklist, DEBUG=False)}}]{\setlength{\rightskip}{0pt plus 5cm}def loginhashblock.\+get\+\_\+loginhashblock (
\begin{DoxyParamCaption}
\item[{}]{devid, }
\item[{}]{loginhashblocklist, }
\item[{}]{D\+E\+B\+UG = {\ttfamily False}}
\end{DoxyParamCaption}
)}\hypertarget{namespaceloginhashblock_ab2ceb1d30aad9af290ac7d44e9f95bf2}{}\label{namespaceloginhashblock_ab2ceb1d30aad9af290ac7d44e9f95bf2}
\begin{DoxyVerb}This function is to get login hash block by device id in login hash block list.
:devid: device id
:loginhashblocklist: client's login has block in database
:return:
\end{DoxyVerb}
 

Definition at line 327 of file loginhashblock.\+py.


\begin{DoxyCode}
327 \textcolor{keyword}{def }\hyperlink{namespaceloginhashblock_ab2ceb1d30aad9af290ac7d44e9f95bf2}{get\_loginhashblock}(devid, loginhashblocklist, DEBUG=False):
328     \textcolor{stringliteral}{"""}
329 \textcolor{stringliteral}{    This function is to get login hash block by device id in login hash block list.}
330 \textcolor{stringliteral}{    :devid: device id}
331 \textcolor{stringliteral}{    :loginhashblocklist: client's login has block in database}
332 \textcolor{stringliteral}{    :return:}
333 \textcolor{stringliteral}{    """}
334 
335     \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} loginhashblocklist:
336         \_devid = \hyperlink{namespaceloginhashblock_a1908d7c90a7ea1a7f84eeac3a1378b57}{get\_deviceId}(i, DEBUG=DEBUG)
337         \textcolor{keywordflow}{if} devid == \_devid:
338             \textcolor{keywordflow}{if} DEBUG:
339                 print(\textcolor{stringliteral}{'[info:get\_loginhashblock] devid is found in login hash block list'})
340             \textcolor{keywordflow}{return} i
341 
342     \textcolor{keywordflow}{if} DEBUG:
343         print(\textcolor{stringliteral}{'[info:get\_loginhashblock] devid is not found in login hash block list'})
344 
345     \textcolor{keywordflow}{return} \textcolor{keyword}{False}
346 
\end{DoxyCode}


Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceloginhashblock_ab2ceb1d30aad9af290ac7d44e9f95bf2_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceloginhashblock_ab2ceb1d30aad9af290ac7d44e9f95bf2_icgraph}
\end{center}
\end{figure}


\index{loginhashblock@{loginhashblock}!is\+Registed\+L\+HB@{is\+Registed\+L\+HB}}
\index{is\+Registed\+L\+HB@{is\+Registed\+L\+HB}!loginhashblock@{loginhashblock}}
\subsubsection[{\texorpdfstring{is\+Registed\+L\+H\+B(client\+\_\+loginhashblock, L\+H\+Bliststr, D\+E\+B\+U\+G=\+False)}{isRegistedLHB(client_loginhashblock, LHBliststr, DEBUG=False)}}]{\setlength{\rightskip}{0pt plus 5cm}def loginhashblock.\+is\+Registed\+L\+HB (
\begin{DoxyParamCaption}
\item[{}]{client\+\_\+loginhashblock, }
\item[{}]{L\+H\+Bliststr, }
\item[{}]{D\+E\+B\+UG = {\ttfamily False}}
\end{DoxyParamCaption}
)}\hypertarget{namespaceloginhashblock_a978cb4557443cefddac883f3d92ad8e1}{}\label{namespaceloginhashblock_a978cb4557443cefddac883f3d92ad8e1}
\begin{DoxyVerb}This function is to check valid previous login hash block.
:client_loginhashblock: client's login hash block
:LHBliststr: client's login has block in database
\end{DoxyVerb}
 

Definition at line 304 of file loginhashblock.\+py.


\begin{DoxyCode}
304 \textcolor{keyword}{def }\hyperlink{namespaceloginhashblock_a978cb4557443cefddac883f3d92ad8e1}{isRegistedLHB}(client\_loginhashblock, LHBliststr, DEBUG=False):
305     \textcolor{stringliteral}{"""}
306 \textcolor{stringliteral}{    This function is to check valid previous login hash block.}
307 \textcolor{stringliteral}{    :client\_loginhashblock: client's login hash block}
308 \textcolor{stringliteral}{    :LHBliststr: client's login has block in database}
309 \textcolor{stringliteral}{    """}
310 
311     server\_loginhashblocklist = LHBliststr.split(\textcolor{stringliteral}{','})
312 
313     \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} \hyperlink{namespaceloginhashblock_ac120dd8384bd51c357e2ad5f6cb2f99a}{valid\_loginhashblock}(client\_loginhashblock, DEBUG=DEBUG):
314         \textcolor{keywordflow}{return} \textcolor{keyword}{False}
315 
316     devid = \hyperlink{namespaceloginhashblock_a1908d7c90a7ea1a7f84eeac3a1378b57}{get\_deviceId}(client\_loginhashblock, DEBUG=DEBUG)
317     server\_loginhashblock = \hyperlink{namespaceloginhashblock_ab2ceb1d30aad9af290ac7d44e9f95bf2}{get\_loginhashblock}(devid, server\_loginhashblocklist, DEBUG=
      DEBUG)
318 
319     \textcolor{keywordflow}{if} DEBUG:
320         print(\textcolor{stringliteral}{"[info:isRegistedLHB]\(\backslash\)nclient\_loginhashblock: \{\}\(\backslash\)nserver\_loginhashblock: \{\}"}.format(
      client\_loginhashblock, server\_loginhashblock))
321 
322     \textcolor{keywordflow}{if} client\_loginhashblock == server\_loginhashblock:
323         \textcolor{keywordflow}{return} \textcolor{keyword}{True}
324 
325     \textcolor{keywordflow}{return} \textcolor{keyword}{False}
326 
\end{DoxyCode}


Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceloginhashblock_a978cb4557443cefddac883f3d92ad8e1_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceloginhashblock_a978cb4557443cefddac883f3d92ad8e1_icgraph}
\end{center}
\end{figure}


\index{loginhashblock@{loginhashblock}!pbkdf2\+\_\+hash@{pbkdf2\+\_\+hash}}
\index{pbkdf2\+\_\+hash@{pbkdf2\+\_\+hash}!loginhashblock@{loginhashblock}}
\subsubsection[{\texorpdfstring{pbkdf2\+\_\+hash(data, salt, iterations, dklen=\+None, hash\+\_\+name=""sha256"", D\+E\+B\+U\+G=\+False)}{pbkdf2_hash(data, salt, iterations, dklen=None, hash_name="sha256", DEBUG=False)}}]{\setlength{\rightskip}{0pt plus 5cm}def loginhashblock.\+pbkdf2\+\_\+hash (
\begin{DoxyParamCaption}
\item[{}]{data, }
\item[{}]{salt, }
\item[{}]{iterations, }
\item[{}]{dklen = {\ttfamily None}, }
\item[{}]{hash\+\_\+name = {\ttfamily \char`\"{}sha256\char`\"{}}, }
\item[{}]{D\+E\+B\+UG = {\ttfamily False}}
\end{DoxyParamCaption}
)}\hypertarget{namespaceloginhashblock_a104d0a92cdfb6c337794b6ded42667d4}{}\label{namespaceloginhashblock_a104d0a92cdfb6c337794b6ded42667d4}
\begin{DoxyVerb}The function provides PKCS#5 password-based key derivation function.
It uses HMAC as pseudorandom function.
eturn the hexadecimal representation of the binary data. Every byte of data is converted into the corresponding 2-digit hex representation.
:param data: data and salt are interpreted as buffers of byte
:param salt: data and salt are interpreted as buffers of byte
:param iterations: The number of iterations should be chosen based on the hash algorithm and computing power. As of 2013, at least 100,000 iterations of SHA-256 are suggested.
:param dklen: dklen is the length of the derived key. If dklen is None then the digest size of the hash algorithm hash_name is used, e.g. 64 for SHA-512.
:param hash_name: hash_name is the desired name of the hash digest algorithm for HMAC(default: sha256)
:param DEBUG: debug option flags
:return:
\end{DoxyVerb}
 

Definition at line 44 of file loginhashblock.\+py.


\begin{DoxyCode}
44 \textcolor{keyword}{def }\hyperlink{namespaceloginhashblock_a104d0a92cdfb6c337794b6ded42667d4}{pbkdf2\_hash}(data, salt, iterations, dklen=None, hash\_name="sha256", DEBUG=False):
45     \textcolor{stringliteral}{"""}
46 \textcolor{stringliteral}{    The function provides PKCS#5 password-based key derivation function.}
47 \textcolor{stringliteral}{    It uses HMAC as pseudorandom function.}
48 \textcolor{stringliteral}{    eturn the hexadecimal representation of the binary data. Every byte of data is converted into the
       corresponding 2-digit hex representation.}
49 \textcolor{stringliteral}{    :param data: data and salt are interpreted as buffers of byte}
50 \textcolor{stringliteral}{    :param salt: data and salt are interpreted as buffers of byte}
51 \textcolor{stringliteral}{    :param iterations: The number of iterations should be chosen based on the hash algorithm and computing
       power. As of 2013, at least 100,000 iterations of SHA-256 are suggested.}
52 \textcolor{stringliteral}{    :param dklen: dklen is the length of the derived key. If dklen is None then the digest size of the hash
       algorithm hash\_name is used, e.g. 64 for SHA-512.}
53 \textcolor{stringliteral}{    :param hash\_name: hash\_name is the desired name of the hash digest algorithm for HMAC(default: sha256)}
54 \textcolor{stringliteral}{    :param DEBUG: debug option flags}
55 \textcolor{stringliteral}{    :return:}
56 \textcolor{stringliteral}{    """}
57 
58     \textcolor{keywordflow}{if} DEBUG:
59         print(\textcolor{stringliteral}{'[info:pdkdf2\_ascii] hash: '}, hash\_name)
60         print(\textcolor{stringliteral}{'[info:pdkdf2\_ascii] iterations: '}, iterations)
61         print(\textcolor{stringliteral}{'[info:pdkdf2\_ascii] data: '}, data.encode(\textcolor{stringliteral}{'ascii'}))
62         print(\textcolor{stringliteral}{'[info:pdkdf2\_ascii] salt: '}, salt.encode(\textcolor{stringliteral}{'ascii'}))
63 
64     dk = hashlib.pbkdf2\_hmac(hash\_name, data.encode(\textcolor{stringliteral}{'ascii'}), salt.encode(\textcolor{stringliteral}{'ascii'}), iterations, dklen=dklen
      )
65     hex = binascii.hexlify(dk)
66     \textcolor{keywordflow}{return} hex.decode(\textcolor{stringliteral}{'ascii'})
67 
\end{DoxyCode}


Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceloginhashblock_a104d0a92cdfb6c337794b6ded42667d4_icgraph}
\end{center}
\end{figure}


\index{loginhashblock@{loginhashblock}!print\+\_\+\+L\+H\+Blist@{print\+\_\+\+L\+H\+Blist}}
\index{print\+\_\+\+L\+H\+Blist@{print\+\_\+\+L\+H\+Blist}!loginhashblock@{loginhashblock}}
\subsubsection[{\texorpdfstring{print\+\_\+\+L\+H\+Blist(\+L\+H\+Bliststr, D\+E\+B\+U\+G=\+False)}{print_LHBlist(LHBliststr, DEBUG=False)}}]{\setlength{\rightskip}{0pt plus 5cm}def loginhashblock.\+print\+\_\+\+L\+H\+Blist (
\begin{DoxyParamCaption}
\item[{}]{L\+H\+Bliststr, }
\item[{}]{D\+E\+B\+UG = {\ttfamily False}}
\end{DoxyParamCaption}
)}\hypertarget{namespaceloginhashblock_af47615d0e87d554eae9e6d49131fe49c}{}\label{namespaceloginhashblock_af47615d0e87d554eae9e6d49131fe49c}
\begin{DoxyVerb}The function prints login hash block list for debug.
:param LHBliststr:
:return:
\end{DoxyVerb}
 

Definition at line 21 of file loginhashblock.\+py.


\begin{DoxyCode}
21 \textcolor{keyword}{def }\hyperlink{namespaceloginhashblock_af47615d0e87d554eae9e6d49131fe49c}{print\_LHBlist}(LHBliststr, DEBUG=False):
22     \textcolor{stringliteral}{"""}
23 \textcolor{stringliteral}{    The function prints login hash block list for debug.}
24 \textcolor{stringliteral}{    :param LHBliststr:}
25 \textcolor{stringliteral}{    :return:}
26 \textcolor{stringliteral}{    """}
27 
28     \textcolor{keywordflow}{if} LHBliststr == \textcolor{keywordtype}{None}:
29         text = \textcolor{stringliteral}{'[info:print\_LHBlist] user.Lhashblock:\(\backslash\)n\{\}'}.format(LHBliststr)
30         \textcolor{keywordflow}{return} \textcolor{keyword}{True}
31 
32     \textcolor{keywordflow}{if} len(LHBliststr) < 1:
33         text = \textcolor{stringliteral}{'[info:print\_LHBlist] user.Lhashblock:\(\backslash\)n\{\}'}.format(LHBliststr)
34         print(text)
35     \textcolor{keywordflow}{else}:
36         hblist = LHBliststr.split(\textcolor{stringliteral}{','})
37         text = \textcolor{stringliteral}{'[info:print\_LHBlist] user.Lhashblock:'}
38         print(text)
39         \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} hblist:
40             print(i)
41 
42     \textcolor{keywordflow}{return} \textcolor{keyword}{True}
43 
\end{DoxyCode}


Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=326pt]{namespaceloginhashblock_af47615d0e87d554eae9e6d49131fe49c_icgraph}
\end{center}
\end{figure}


\index{loginhashblock@{loginhashblock}!update\+\_\+loginhashblock@{update\+\_\+loginhashblock}}
\index{update\+\_\+loginhashblock@{update\+\_\+loginhashblock}!loginhashblock@{loginhashblock}}
\subsubsection[{\texorpdfstring{update\+\_\+loginhashblock(prev\+\_\+loginhashblock, D\+E\+B\+U\+G=\+False)}{update_loginhashblock(prev_loginhashblock, DEBUG=False)}}]{\setlength{\rightskip}{0pt plus 5cm}def loginhashblock.\+update\+\_\+loginhashblock (
\begin{DoxyParamCaption}
\item[{}]{prev\+\_\+loginhashblock, }
\item[{}]{D\+E\+B\+UG = {\ttfamily False}}
\end{DoxyParamCaption}
)}\hypertarget{namespaceloginhashblock_ab6bafe3dab103cc698822367e53d4a64}{}\label{namespaceloginhashblock_ab6bafe3dab103cc698822367e53d4a64}
\begin{DoxyVerb}This function is to update login hash block with old login hash block
:param prev_loginhashblock:
:param DEBUG:
:return: updated login hash block
\end{DoxyVerb}
 

Definition at line 281 of file loginhashblock.\+py.


\begin{DoxyCode}
281 \textcolor{keyword}{def }\hyperlink{namespaceloginhashblock_ab6bafe3dab103cc698822367e53d4a64}{update\_loginhashblock}(prev\_loginhashblock, DEBUG=False):
282     \textcolor{stringliteral}{"""}
283 \textcolor{stringliteral}{    This function is to update login hash block with old login hash block}
284 \textcolor{stringliteral}{    :param prev\_loginhashblock:}
285 \textcolor{stringliteral}{    :param DEBUG:}
286 \textcolor{stringliteral}{    :return: updated login hash block}
287 \textcolor{stringliteral}{    """}
288 
289     \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} prev\_loginhashblock:
290         \textcolor{keywordflow}{return} \textcolor{keywordtype}{None}
291 
292     \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} \hyperlink{namespaceloginhashblock_ac120dd8384bd51c357e2ad5f6cb2f99a}{valid\_loginhashblock}(prev\_loginhashblock, DEBUG=DEBUG):
293         \textcolor{keywordflow}{raise} ValueError(\textcolor{stringliteral}{"[info:update\_loginhashblock] Invalid login hash block"})
294 
295     devid = \hyperlink{namespaceloginhashblock_a1908d7c90a7ea1a7f84eeac3a1378b57}{get\_deviceId}(prev\_loginhashblock, DEBUG=DEBUG)
296     loginhashblock = \hyperlink{namespaceloginhashblock_ad3ef8dab740c69ca8424797f9c146a53}{create\_loginhashblock}(devid, DEBUG=DEBUG)
297 
298     \textcolor{keywordflow}{if} DEBUG:
299         text = \textcolor{stringliteral}{'[info:update\_loginhashblock] \(\backslash\)npre\_loginhashblock: \{\}\(\backslash\)nnew\_loginhashblock: \{\}'}.format(
      prev\_loginhashblock,loginhashblock)
300         print(text)
301 
302     \textcolor{keywordflow}{return} loginhashblock
303 
\end{DoxyCode}


Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceloginhashblock_ab6bafe3dab103cc698822367e53d4a64_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceloginhashblock_ab6bafe3dab103cc698822367e53d4a64_icgraph}
\end{center}
\end{figure}


\index{loginhashblock@{loginhashblock}!update\+\_\+loginhashblocklist@{update\+\_\+loginhashblocklist}}
\index{update\+\_\+loginhashblocklist@{update\+\_\+loginhashblocklist}!loginhashblock@{loginhashblock}}
\subsubsection[{\texorpdfstring{update\+\_\+loginhashblocklist(\+L\+H\+Blist\+Str, prev\+\_\+\+L\+H\+B, D\+E\+B\+U\+G=\+False)}{update_loginhashblocklist(LHBlistStr, prev_LHB, DEBUG=False)}}]{\setlength{\rightskip}{0pt plus 5cm}def loginhashblock.\+update\+\_\+loginhashblocklist (
\begin{DoxyParamCaption}
\item[{}]{L\+H\+Blist\+Str, }
\item[{}]{prev\+\_\+\+L\+HB, }
\item[{}]{D\+E\+B\+UG = {\ttfamily False}}
\end{DoxyParamCaption}
)}\hypertarget{namespaceloginhashblock_a7baa4021b9f57044f8227c2e0320ee2b}{}\label{namespaceloginhashblock_a7baa4021b9f57044f8227c2e0320ee2b}
\begin{DoxyVerb}This function update login hash block list.
:param LHBlistStr: login hash block list
:param loginhashblock: login hash block
:return: updated login hash block list
\end{DoxyVerb}
 

Definition at line 93 of file loginhashblock.\+py.


\begin{DoxyCode}
93 \textcolor{keyword}{def }\hyperlink{namespaceloginhashblock_a7baa4021b9f57044f8227c2e0320ee2b}{update\_loginhashblocklist}(LHBlistStr, prev\_LHB, DEBUG=False):
94     \textcolor{stringliteral}{"""}
95 \textcolor{stringliteral}{    This function update login hash block list.}
96 \textcolor{stringliteral}{    :param LHBlistStr: login hash block list}
97 \textcolor{stringliteral}{    :param loginhashblock: login hash block}
98 \textcolor{stringliteral}{    :return: updated login hash block list}
99 \textcolor{stringliteral}{    """}
100 
101     loginhashblock = \hyperlink{namespaceloginhashblock_ab6bafe3dab103cc698822367e53d4a64}{update\_loginhashblock}(prev\_LHB, DEBUG=\textcolor{keyword}{False})
102 
103     \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} loginhashblock:
104         \textcolor{keywordflow}{return} LHBlistStr
105 
106     devid = \hyperlink{namespaceloginhashblock_a1908d7c90a7ea1a7f84eeac3a1378b57}{get\_deviceId}(loginhashblock, DEBUG=DEBUG)
107 
108     \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} LHBlistStr :
109         \textcolor{keywordflow}{if} DEBUG:
110             print(\textcolor{stringliteral}{"[info:update\_loginhashblocklist] LHBlistStr is null"})
111 
112         \textcolor{keywordflow}{return} loginhashblock
113 
114     LHBlist = LHBlistStr.split(\textcolor{stringliteral}{','})
115 
116     \textcolor{keywordflow}{for} i,v \textcolor{keywordflow}{in} enumerate(LHBlist):
117         \_devid = \hyperlink{namespaceloginhashblock_a1908d7c90a7ea1a7f84eeac3a1378b57}{get\_deviceId}(v, DEBUG=DEBUG)
118         \textcolor{keywordflow}{if} devid == \_devid:
119             LHBlist[i] = loginhashblock
120             \textcolor{keywordflow}{return} \textcolor{stringliteral}{","}.join(LHBlist)
121 
122     LHBlist.append(loginhashblock)
123 
124     \textcolor{keywordflow}{if} DEBUG:
125         print(\textcolor{stringliteral}{"[info:update\_loginhashblocklist] devid: \{\}"}.format(devid))
126         print(\textcolor{stringliteral}{"[info:update\_loginhashblocklist] db\_hashblock: \{\}"}.format(len(LHBlist)))
127 
128     \textcolor{keywordflow}{return} \textcolor{stringliteral}{","}.join(LHBlist)
129 
\end{DoxyCode}


Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceloginhashblock_a7baa4021b9f57044f8227c2e0320ee2b_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceloginhashblock_a7baa4021b9f57044f8227c2e0320ee2b_icgraph}
\end{center}
\end{figure}


\index{loginhashblock@{loginhashblock}!valid\+\_\+hash@{valid\+\_\+hash}}
\index{valid\+\_\+hash@{valid\+\_\+hash}!loginhashblock@{loginhashblock}}
\subsubsection[{\texorpdfstring{valid\+\_\+hash(target\+\_\+hash, salt, target, method, D\+E\+B\+U\+G=\+False)}{valid_hash(target_hash, salt, target, method, DEBUG=False)}}]{\setlength{\rightskip}{0pt plus 5cm}def loginhashblock.\+valid\+\_\+hash (
\begin{DoxyParamCaption}
\item[{}]{target\+\_\+hash, }
\item[{}]{salt, }
\item[{}]{target, }
\item[{}]{method, }
\item[{}]{D\+E\+B\+UG = {\ttfamily False}}
\end{DoxyParamCaption}
)}\hypertarget{namespaceloginhashblock_ac7faa165bc305e611390727f11946424}{}\label{namespaceloginhashblock_ac7faa165bc305e611390727f11946424}
\begin{DoxyVerb}This function is to check hash block
:param target_hash:
:param salt:
:param target:
:param method:
:return:
\end{DoxyVerb}
 

Definition at line 163 of file loginhashblock.\+py.


\begin{DoxyCode}
163 \textcolor{keyword}{def }\hyperlink{namespaceloginhashblock_ac7faa165bc305e611390727f11946424}{valid\_hash}(target\_hash, salt, target, method, DEBUG=False):
164     \textcolor{stringliteral}{"""}
165 \textcolor{stringliteral}{    This function is to check hash block}
166 \textcolor{stringliteral}{    :param target\_hash:}
167 \textcolor{stringliteral}{    :param salt:}
168 \textcolor{stringliteral}{    :param target:}
169 \textcolor{stringliteral}{    :param method:}
170 \textcolor{stringliteral}{    :return:}
171 \textcolor{stringliteral}{    """}
172 
173     \textcolor{keywordflow}{if} method.count(\textcolor{stringliteral}{":"}) != 2:
174         \textcolor{keywordflow}{return} \textcolor{keyword}{False}
175 
176     kdf, hash\_name, iterations = method.split(\textcolor{stringliteral}{":"}, 2)
177     hash, method = \hyperlink{namespaceloginhashblock_a935d8ae1c51e50f9e5db6a1d5f02b1b8}{create\_hash}(salt, target, hash\_name=hash\_name, iterations=int(iterations), 
      kdf=kdf)
178     ret = \hyperlink{namespaceloginhashblock_ac24dd842eb90e0ede55e842d44148d5b}{compare\_loginhashblock}(hash, target\_hash)
179 
180     \textcolor{keywordflow}{if} DEBUG:
181         print(\textcolor{stringliteral}{"[info:valid\_hash]        hash: "}, hash)
182         print(\textcolor{stringliteral}{"[info:valid\_hash] target\_hash: "}, target\_hash)
183         print(\textcolor{stringliteral}{"[info:valid\_hash]         ret: "}, ret)
184 
185     \textcolor{keywordflow}{return} ret
186 
\end{DoxyCode}


Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceloginhashblock_ac7faa165bc305e611390727f11946424_cgraph}
\end{center}
\end{figure}


\index{loginhashblock@{loginhashblock}!valid\+\_\+loginhashblock@{valid\+\_\+loginhashblock}}
\index{valid\+\_\+loginhashblock@{valid\+\_\+loginhashblock}!loginhashblock@{loginhashblock}}
\subsubsection[{\texorpdfstring{valid\+\_\+loginhashblock(loginhashblock, D\+E\+B\+U\+G=\+False)}{valid_loginhashblock(loginhashblock, DEBUG=False)}}]{\setlength{\rightskip}{0pt plus 5cm}def loginhashblock.\+valid\+\_\+loginhashblock (
\begin{DoxyParamCaption}
\item[{}]{loginhashblock, }
\item[{}]{D\+E\+B\+UG = {\ttfamily False}}
\end{DoxyParamCaption}
)}\hypertarget{namespaceloginhashblock_ac120dd8384bd51c357e2ad5f6cb2f99a}{}\label{namespaceloginhashblock_ac120dd8384bd51c357e2ad5f6cb2f99a}
\begin{DoxyVerb}This function is to check login hash block
hashblock format: deviceid(8)+$+hash
ex)jUs6LQMX$jUs6LQMX$ceccffbfa52e55825f87573b068c8d759b1540f9833a7d7ebd7a27c993ffd316
:param hashblock:
:return: BOOL
\end{DoxyVerb}
 

Definition at line 251 of file loginhashblock.\+py.


\begin{DoxyCode}
251 \textcolor{keyword}{def }\hyperlink{namespaceloginhashblock_ac120dd8384bd51c357e2ad5f6cb2f99a}{valid\_loginhashblock}(loginhashblock, DEBUG=False):
252     \textcolor{stringliteral}{"""}
253 \textcolor{stringliteral}{    This function is to check login hash block}
254 \textcolor{stringliteral}{    hashblock format: deviceid(8)+$+hash}
255 \textcolor{stringliteral}{    ex)jUs6LQMX$jUs6LQMX$ceccffbfa52e55825f87573b068c8d759b1540f9833a7d7ebd7a27c993ffd316}
256 \textcolor{stringliteral}{    :param hashblock:}
257 \textcolor{stringliteral}{    :return: BOOL}
258 \textcolor{stringliteral}{    """}
259     \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} loginhashblock:
260         \textcolor{keywordflow}{if} DEBUG:
261             print(\textcolor{stringliteral}{'[info:valid\_loginhashblock] Null'})
262         \textcolor{keywordflow}{return} \textcolor{keyword}{False}
263 
264     \textcolor{keywordflow}{if} loginhashblock.count(\textcolor{stringliteral}{"$"}) != 1:
265         \textcolor{keywordflow}{if} DEBUG:
266             print(\textcolor{stringliteral}{'[info:valid\_loginhashblock] Invalid format'})
267         \textcolor{keywordflow}{return} \textcolor{keyword}{False}
268 
269     devid, hash = loginhashblock.split(\textcolor{stringliteral}{"$"}, 1)
270 
271     \textcolor{keywordflow}{if} len(devid) != 8:
272         \textcolor{keywordflow}{if} DEBUG:
273             print(\textcolor{stringliteral}{'[info:valid\_loginhashblock] Invalid deviceid'})
274         \textcolor{keywordflow}{return} \textcolor{keyword}{False}
275 
276     \textcolor{keywordflow}{if} DEBUG:
277         print(\textcolor{stringliteral}{'[info:valid\_loginhashblock] login hash block is valid'})
278 
279     \textcolor{keywordflow}{return} \textcolor{keyword}{True}
280 
\end{DoxyCode}


Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceloginhashblock_ac120dd8384bd51c357e2ad5f6cb2f99a_icgraph}
\end{center}
\end{figure}




\subsection{Variable Documentation}
\index{loginhashblock@{loginhashblock}!D\+E\+B\+UG@{D\+E\+B\+UG}}
\index{D\+E\+B\+UG@{D\+E\+B\+UG}!loginhashblock@{loginhashblock}}
\subsubsection[{\texorpdfstring{D\+E\+B\+UG}{DEBUG}}]{\setlength{\rightskip}{0pt plus 5cm}bool loginhashblock.\+D\+E\+B\+UG = False}\hypertarget{namespaceloginhashblock_ad198a2ffc3d7bab32167aed00d2f5c65}{}\label{namespaceloginhashblock_ad198a2ffc3d7bab32167aed00d2f5c65}


Definition at line 18 of file loginhashblock.\+py.

